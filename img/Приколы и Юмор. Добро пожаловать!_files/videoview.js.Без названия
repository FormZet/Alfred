!function(e){function i(o){if(t[o])return t[o].exports;var a=t[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var t={};return i.m=e,i.c=t,i.p="",i(0)}([function(e,i,t){e.exports=t(11)},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={initPlayer:function(e,i,t){hide(domByClass(e,"video_box_msg")),VideoInitializer[i].apply(VideoInitializer,[e].concat(t)),stManager.add("notifier.js",function(){var e=Videoview.togglePlay.pbind(!1);Notifier.addRecvClbk("audio_start","video",e),Notifier.addRecvClbk("video_start","video",e),Notifier.addRecvClbk("videocall_start","video",e)})},vk:function(e){function i(i,t){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(e,i){var t=i.oid+"_"+i.vid;if(i.vsegs)ls.remove("vsegs"+vk.id+"_"+t);else{var o=ls.get("vsegs"+vk.id+"_"+t);o&&o.ts&&o.segments&&vkNow()-o.ts<864e5&&(i.vsegs=o.segments.replace(/[^0-9\,\|]/gi,""))}window.onLoaded(function(){window.checkMp4(function(t,o){t&&!i.is_flv||browser.flash>=Videoview.FLASH_MIN_VERSION||i.live?(i.can_play_mp4=t?1:0,VideoInitializer.vkHtml5(e,i)):show(domByClass(e,"video_box_msg")),!t&&o&&window._ua&&window._ua.indexOf("smart-tv")>-1&&ajax.post("al_video.php?act=log_cant_play_mp4_reason",{ua:window._ua,reason:o},{onFail:function(){return!0}})})})}),vkHtml5:function(e,i){function t(){if(bodyNode.contains(e)){var t=void 0;if(o&&mvcur.player?(t=mvcur.player,t.initVideo(i)):(t=new VideoPlayer(i),o?mvcur.player=t:i.is_embed?cur.player=t:cur.videoInlinePlayer=t),isFunction(i.onPlayerLoaded)&&i.onPlayerLoaded(t),!a){var n=ce("div",{id:"video_player"});attr(n,"preventhide",1),n.appendChild(t.el),e.appendChild(n)}}}var o=window.mvLayer&&window.mvLayer.contains(e),a=o&&mvcur.player&&e.contains(mvcur.player.el);a||val(e,"");var n=new callHub(t);i.hls_candy_server&&!window.Candy&&(n.count++,window.loadScript("https://cdn.candy.systems/js/vk/candy2.min.js",{timeout:5e3,onLoad:function(){n.done()},onError:function(){delete i.hls_candy,n.done()}}));var r=["videoplayer.js","videoplayer.css"];i.hls&&r.push("hls.min.js"),stManager.add(r,function(){n.done()})},youtube:function(e,i){var t=i.oid,o=i.vid,a=i.report_error_hash;window.onYouTubeIframeAPIReady=function(){var n=domByClass(e,"video_yt_player"),r=new window.YT.Player(n,{events:{onError:function(e){var i=[100,101,150];e.data&&-1!=i.indexOf(e.data)&&ajax.post("al_video.php?act=reparseDeletedYoutube",{vid:o,oid:t}),debugLog("YT player error",arguments),ajax.post("al_video.php?act=external_error",{oid:t,vid:o,hash:a})},onStateChange:function(e){switch(e.data){case window.YT.PlayerState.ENDED:stManager.add(["videoview.js","videoview.css"],function(){var e=ge("video_yt");Videoview.onExternalVideoEnded(e)});break;default:ge("mv_external_finish")&&Videoview.removeExternalVideoFinishBlock()}}}});stManager.add(["video_youtube.js","video_youtube.css"],function(){VideoYoutube.initStatOnly(r,i)})},window.YT?window.onYouTubeIframeAPIReady():!function(e){var i=ce("script",{async:!0,src:"https://www.youtube.com/iframe_api"}),t=geByTag1("script");t.parentNode.insertBefore(i,t)}(document)},iframeOrFlash:function(e,i,t,o,a,n){o&&(browser.flash<Videoview.FLASH_MIN_VERSION||!i)?val(e,'<iframe class="extra_player" type="text/html" width="100%" height="100%" src="'+o+'" frameborder="0" '+a+"></iframe>"):(t=extend({stats:"",from:"vk"},t),VideoInitializer.flash(e,i,t)),n&&setTimeout(function(){cur&&cur.incViews&&cur.incViews()},100)},flash:function(e,i,t,o){if(browser.flash<Videoview.FLASH_MIN_VERSION)return void show(domByClass(e,"video_box_msg"));var a={url:i,id:"video_player",width:"100%",height:"100%",preventhide:1,version:11};o=extend({allowfullscreen:!0,allowscriptaccess:"never",bgcolor:"#000000",wmode:"opaque"},o),renderFlash(e,a,o,t)}}},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={action:function(e,i,t){if("moder_log"==i)this.showModerLogBox();else if("region_mask"==i)this.showRegionMaskBox();else{var o=extend({owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,action:i,hash:t},JSON.parse(domData(e,"params")));ajax.post("al_video.php?act=moder_action",o,{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){showProgress(e),disableEl(e)}),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){enableEl(e),hideProgress(e)}),onDone:function(i,t,o){i&&val(e,i),t&&domData(e,"params",t),o&&lockLink(e)}})}},pin:function(e){var i=domByClass("mv_moder_buttons","mv_moder_buttons_pin"),t=domByClass("mv_moder_buttons","_ui_menu_wrap"),o=e?ls.get("video_moder_actions_pinned"):!domData(i,"pinned");o?(t.onmouseenter=t.onmouseleave=null,uiActionsMenu.show(t),val(i,"Unpin"),domData(i,"pinned",1),ls.set("video_moder_actions_pinned",1)):(t.onmouseenter=function(){uiActionsMenu.show(this)},t.onmouseleave=function(){uiActionsMenu.hide(this)},val(i,"Pin"),domData(i,"pinned",null),ls.remove("video_moder_actions_pinned"))},showModerLogBox:function(){showBox("al_video.php?act=moder_log_box",{video_raw:mvcur.videoRaw},{params:{width:600}})},showRegionMaskBox:function(){function e(e){var i=e.currentTarget;checkbox(i)}function i(){each(a,function(e,i){checkbox(i,inArray(e,n))})}function t(){each(a,function(e,i){checkbox(i,!1)})}function o(){var e=[];each(a,function(i,t){isChecked(t)&&e.push(i)}),ajax.post("al_video.php?act=region_mask_save",{video:mvcur.videoRaw,regions:e.join(","),hash:r},{onDone:function(){curBox().hide()}})}var a={},n=void 0,r=void 0;showBox("al_video.php?act=region_mask_box",{video:mvcur.videoRaw},{onDone:function(d,s){n=s.cis_countries,r=s.save_hash;var l="";each(s.regions,function(e,i){l+='<div class="checkbox '+(i?"on":"")+'" style="display:inline-block;width:20%;" data-value="'+e+'">'+e+"</div>"}),l+='\n          <br><br>\n          <button class="flat_button button_small secondary _check_cis_only" style="margin-right:10px">Только СНГ</button>\n          <button class="flat_button button_small secondary _uncheck_all">Убрать ограничения</button>\n        ',d.content(l),geByClass("checkbox",d.bodyNode).forEach(function(i){var t=domData(i,"value");a[t]=i,i.onclick=e}),domByClass(d.bodyNode,"_check_cis_only").onclick=i,domByClass(d.bodyNode,"_uncheck_all").onclick=t,d.removeButtons(),d.addButton(getLang("global_save"),o)}})}}},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={init:function(e,i){function t(e){var i=domClosest("olist_item_wrap",e.target);if(i){cancelEvent(e);var t=domData(i,"id");toggleClass(i,"olist_item_wrap_on")?c[t]=1:delete c[t]}}function o(e){var t=e;if(e=trim(e).replace(/\s+/g," ").toLowerCase(),e!==l){l=e;var o=e?s.search(e):i.list,a="";if(o.length)for(var n,r=new RegExp(e,"i"),v=0;v<o.length;v++)n=o[v],a+=getTemplate("video_live_blacklist_item",{id:n.id,href:n.href,photo:n.photo,name:e?n.name.replace(r,"<em>$&</em>"):n.name,"class":c[n.id]?" olist_item_wrap_on":""});else a=getTemplate("video_live_blacklist_empty",{text:langStr(getLang("global_search_not_found"),"search","<b>"+clean(t)+"</b>")});val(d,a)}}function a(t){ajax.post("al_video.php?act=save_live_blacklist",{exclude:Object.keys(c).join(","),hash:i.save_hash},{onDone:function(i){e.hide(),i&&showDoneBox(i)},showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)})}e.setOptions({bodyStyle:"padding:0;",onDestroy:function(){uiSearch.destroy(n),v&&v.destroy(),e=s=v=r=n=null}});var n=ge("video_live_blacklist_search"),r=ge("video_live_blacklist_wrap"),d=domByClass(r,"olist"),s=void 0,l=void 0,v=void 0,c={};i.list.length&&(e.removeButtons().addButton(getLang("global_save"),a).addButton(getLang("global_cancel"),null,"no"),v=new uiScroll(r),o(""),r.onclick=t,n&&(s=new vkIndexer(i.list,function(e){return e.name+" https://vk.com"+e.href}),uiSearch.init(n,{onChange:o}),uiSearch.focus(n)))}}},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=function(){function e(e,i){var t=[],o=!0,a=!1,n=void 0;try{for(var r,d=e[Symbol.iterator]();!(o=(r=d.next()).done)&&(t.push(r.value),!i||t.length!==i);o=!0);}catch(s){a=!0,n=s}finally{try{!o&&d["return"]&&d["return"]()}finally{if(a)throw n}}return t}return function(i,t){if(Array.isArray(i))return i;if(Symbol.iterator in Object(i))return e(i,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();i["default"]={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:150,MAX_LIKES_PER_BATCH:7,MAX_STICKERS_PER_BATCH:7,init:function(e,i){VideoChat.block&&VideoChat.destroy(),e&&(VideoChat.block=e,VideoChat.options=extend({},i),VideoChat.messagesWrap=domByClass(e,"mv_chat_messages_wrap"),VideoChat.stickersWrap=domByClass(e,"mv_chat_stickers_wrap"),VideoChat.scroll=new uiScroll(domFC(VideoChat.messagesWrap),{global:!0,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:VideoChat.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:VideoChat.onScrollUpdate}),this.scrollBottomBtnWrap=domByClass(e,"mv_chat_new_messages_btn_wrap"),VideoChat.replyForm=domByClass(e,"mv_chat_reply_form"),VideoChat.replyForm&&(VideoChat.replyInput=domByClass(e,"mv_chat_reply_input"),VideoChat.initReplyInput()),VideoChat.firstMsgIntro=domByClass(e,"mv_chat_first_message_intro"))},initReplyInput:function(){placeholderInit(VideoChat.replyInput,{editable:!0,global:!0}),stManager.add(["emoji.js","notifier.css"],function(){var e=Emoji.init(VideoChat.replyInput,{forceStickerPack:VideoChat.options.forceStickerPack,controlsCont:VideoChat.replyForm,noLineBreaks:1,noCtrlSend:1,onSend:function(){VideoChat.sendMessage()},checkEditable:function(){VideoChat.checkFormHeight(),VideoChat.checkTextLen()},onStickerSend:function(e){VideoChat.sendSticker(e)}});data(VideoChat.replyForm,"optId",e)})},checkFormHeight:function(){var e=VideoChat.replyForm,i=e.offsetHeight;if(e.lastHeight!==i){e.lastHeight=i;var t=!VideoChat.scroll.data.scrollBottom;setStyle(VideoChat.messagesWrap,{bottom:i+"px"}),t&&VideoChat.scroll.scrollBottom()}},checkTextLen:function(){var e=VideoChat.replyInput,i=trim(Emoji.editableVal(e));if(e.lastLen!==i.length){var t=e.lastLen=i.length,o=mvcur.maxChatReplyLength;t>o?showTooltip(e,{text:getLang("video_live_chat_msg_too_long"),black:1}):window.tooltips&&tooltips.destroy(e)}},mentionOver:function(e){return window.mentionOver(e,{shift:[-20,7,7]})},stickerClick:function(e,i,t){return stManager.add(["emoji.js","notifier.css"],function(){Emoji.clickSticker(e,i,t)}),!1},onScrollUpdate:function(e){e.data.scrollBottom<VideoChat.SCROLL_EDGE_BELOW_THRESHOLD&&VideoChat.toggleScrollBottomBtn(!1)},receiveMessage:function(e,i,t,o,a,n,r,d,s){if(intval(s))return void VideoChat.appendSticker(s,t);var l=!1;window.replyAsList&&window.replyAsList.length&&each(window.replyAsList,function(){return this[0]==t?(l=!0,!1):void 0});var v="";(mvcur.adminLevel>0||e==vk.id||t==vk.id||l)&&(v+=getTemplate("video_chat_message_action_del",{video_owner_id:e,msg_id:i}));var c=psr(getTemplate("video_chat_message",{author_href:n,author_photo:psr(a),author_name:o,message:d,video_owner_id:e,msg_id:i,actions:v,classes:t==e?"mv_chat_admin_message":""}));VideoChat.appendMessage(c,i)},receiveDelete:function(e,i){var t="#mv_chat_msg"+mvcur.mvData.oid+"_"+i,o=VideoChat._messagesBatch&&VideoChat._messagesBatch.querySelector(t);return o?void re(o):(o=VideoChat.messagesWrap.querySelector(t),void(o&&!hasClass(o,"_deleting")&&VideoChat.scroll.updateAbove(function(){re(o)})))},checkStickerFlood:function(e,i){var t=mvcur.queueBatchId;VideoChat._stickersLimits&&VideoChat._stickersLimits.batch==t||(VideoChat._stickersLimits={batch:t,like:0,sticker:0},VideoChat._stickersDelay=0);var o="like"==e?"like":"sticker",a="like"==o?VideoChat.MAX_LIKES_PER_BATCH:VideoChat.MAX_STICKERS_PER_BATCH;return++VideoChat._stickersLimits[o]>a&&i!=vk.id?!1:!0},appendSticker:function(e,i){function t(e){for(var t="",o=0,a=0,n=0,r=intval((VideoChat.getHeight()-80)/6),d=0;100>=d;d+=20){d>0&&(o+=irand(-4,4),a-=r,n+=irand(-4,4),r=intval(.9*r));var s=d?1:.7,l=0==d||100==d?0:1;t+="\n          "+d+"% {\n            transform: translate("+o+"px, "+a+"px) rotate("+n+"deg) scale("+s+");\n            opacity: "+l+";\n          }\n        "}var v="mv_chat_sticker_animation_"+Date.now()+"_"+irand(0,1e9);t="@keyframes "+v+" {"+t+"}",e.appendChild(ce("style",{innerHTML:t}));var c=irand(1500,2500)+"ms",u=(i==vk.id?0:VideoChat._stickersDelay+=100)+"ms";setStyle(e,{animation:[v,c,u,"linear"].join(" ")})}function o(e){var i=e.currentTarget||e,t=VideoChat._stickersBatch||(VideoChat._stickersBatch=document.createDocumentFragment());t.appendChild(i),VideoChat._appendStickerTimeout||(VideoChat._appendStickerTimeout=setTimeout(function(){VideoChat.appendStickersBatch(),VideoChat._appendStickerTimeout=null},0))}function a(e){var i=e.currentTarget||e;removeEvent(i),re(i)}var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;if(!VideoChat.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in bodyNode.style&&"onanimationend"in window){if(i==vk.id){var r=VideoChat.recentlySentSticker;if(r&&r.stickerId==e&&r.fromQueue!=n&&Date.now()-r.time<3e3)return;VideoChat.recentlySentSticker={stickerId:e,fromQueue:n,time:Date.now()}}else if(!VideoChat.checkStickerFlood(e,i))return;if("like"==e){var d=ce("div",{className:"mv_chat_like"});t(d),addEvent(d,"animationend",a),o(d)}else{var s=ce("img",{className:"mv_chat_sticker",src:"/images/stickers/"+e+"/"+(isRetina()?128:64)+"b.png"});t(s),addEvent(s,"error animationend",a),addEvent(s,"load",o)}}},appendStickersBatch:function(){var e=VideoChat._stickersBatch;e&&(VideoChat._stickersBatch=null,VideoChat.isHidden()||VideoChat.stickersWrap.appendChild(e))},removeStickers:function(){if(VideoChat.stickersWrap)for(var e;e=domFC(VideoChat.stickersWrap);)removeEvent(e),re(e)},appendMessage:function(e,i){var t=VideoChat._messagesBatch||(VideoChat._messagesBatch=document.createDocumentFragment()),o="#mv_chat_msg"+mvcur.mvData.oid+"_"+i;if(!VideoChat.messagesWrap.querySelector(o)&&!t.querySelector(o)){t.appendChild(se(e));for(var a=t.childNodes;t.childNodes.length>VideoChat.MAX_COMMENTS_NUM;)re(a[0]);VideoChat.isHidden()||VideoChat._appendMessageTimeout||(VideoChat._appendMessageTimeout=setTimeout(function(){VideoChat.appendMessagesBatch(),VideoChat._appendMessageTimeout=null},0))}},appendMessagesBatch:function(){if(!VideoChat.isHidden()){var e=VideoChat._messagesBatch;if(e){VideoChat._messagesBatch=null;var i=geByClass("mv_chat_message_author_thumb_img",e,"img");each(i,function(e,i){attr(i,"src")||attr(i,"src",domData(i,"src"))}),VideoChat.firstMsgIntro&&(re(VideoChat.firstMsgIntro),VideoChat.firstMsgIntro=null);var t=VideoChat.scroll.content;VideoChat.scroll.updateBelow(function(){t.appendChild(e)}),VideoChat.scroll.updateAbove(function(){for(var e=t.childNodes;e.length>VideoChat.MAX_COMMENTS_NUM;)re(e[0])}),VideoChat.scroll.data.scrollBottom>100&&VideoChat.toggleScrollBottomBtn(!0)}}},toggleScrollBottomBtn:function(e){toggleClass(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom:function(){VideoChat.scroll.scrollBottom(0)},replyAsAnimate:function(e,i,t){var o=e&&geByClass1("mv_chat_reply_author_photo",e),a=o&&geByClass("mv_chat_reply_author_photo_img",o),n=hasClass(e,"mv_chat_author_secondary")?0:1;a&&a[n]&&(a[n].src=t),toggleClass(e,"mv_chat_author_secondary")},replyAsGroup:function(e,i){window.replyAsList?VideoChat.replyAsGroupTT(e,i):ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(o){window.replyAsList=o,window.replyAsData={},each(o,function(e,i){var o=t(i,4),a=o[0];o[1],o[2],o[3];window.replyAsData[a]=this}),VideoChat.replyAsGroupTT(e,i)}})},replyAsGroupList:function(e,i){var o=[i];return each(window.replyAsList,function(i,a){var n=t(a,4),r=n[0];n[1],n[2],n[3];r!=e&&o.push(this)}),o},replyAsGroupOver:function(e){var i=gpeByClass("mv_chat_reply_form",e);showTooltip(e,{text:function(){var e=domData(i,"from-oid")<0;return e?getLang("global_on_behalf_group"):getLang("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT:function(e,i){var o=VideoChat.replyAsProfileData(),a=gpeByClass("mv_chat_reply_form",e),n=a&&domData(a,"from-oid"),r=data(e,"tt");if(!o)return!1;if(!r){var d=VideoChat.replyAsGroupList(i,o),s="";each(d,function(e,i){var o=t(i,4),a=o[0],r=o[1],d=o[2],l=o[3];s+=getTemplate("video_chat_message_author_select_row",{author_id:a,author_href:d,author_photo:r,author_name:l,classes:n==a?" active":""})}),r=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+s+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(i){var t=geByClass("post_from_tt_row",i);each(t,function(i,t){addEvent(t,"click",VideoChat.setReplyAsGroup.pbind(e,{from:domData(this,"from-oid")}))}),this.rows=t,this.scroll=new uiScroll(geByClass1("_post_scroll_wrap",i)),setTimeout(function(){r.scroll.update(),r.updatePosition()},0)},onShow:function(e){setTimeout(function(){if(r.scroll){var i=geByClass1("active",e),t=i?i.offsetTop-(r.scroll.data.viewportHeight-getSize(i)[1])/2:0;r.scroll.scrollTop(t)}},0)},onHide:function(e){}}),data(e,"tt",r)}i&&r.isShown()&&VideoChat.setReplyAsGroup(e,{from:n==vk.id?i:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),r.isShown()||r.show()},replyAsProfileData:function(){return window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},setReplyAsGroup:function(e,i){if(!e)return!1;var t=domClosest("mv_chat_reply_form",e),o=data(e,"tt"),a=i.from||(i.fromGroup?cur.oid:vk.id),n=a==vk.id?VideoChat.replyAsProfileData():window.replyAsData&&window.replyAsData[a];return domData(t,"from-oid")!=a&&n&&n[0]==a?(domData(t,"from-oid",a),VideoChat.replyAsAnimate(t,n[2],n[1]),o&&o.rows&&each(o.rows,function(){toggleClass(this,"active",domData(this,"from-oid")==a)}),e.setAttribute("aria-label",getLang(0>a?"wall_reply_as_group":"wall_reply_as_user")),!1):!1},sendMessage:function(){if(!VideoChat.messageSending){var e={message:trim(Emoji.val(VideoChat.replyInput))};if(!e.message)return void elfocus(VideoChat.replyInput);if(vkNow()-VideoChat.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(VideoChat.replyInput),void showTooltip(VideoChat.replyInput,{text:getLang("video_live_chat_too_fast"),black:1});var i=Videoview.getMvData(),t=geByClass1("mv_chat_reply_form",this.block);t&&domData(t,"from-oid")&&(e.from_oid=domData(t,"from-oid")),ajax.post("al_video.php?act=post_comment",Wall.fixPostParams(extend(e,{video:i.videoRaw,hash:i.hash,fromview:1,videoviewer_chat:1})),{onDone:function(e,i){VideoChat.messageSending=!1,e&&i&&VideoChat.appendMessage(e,i),Emoji.val(VideoChat.replyInput,""),VideoChat.checkFormHeight(),VideoChat.scroll.data.scrollBottom&&VideoChat.scrollBottom(),VideoChat.lastMsgSent=vkNow()},onFail:function(e){return VideoChat.messageSending=!1,VideoChat.replyInput?(window.tooltips&&tooltips.destroy(VideoChat.replyInput),showTooltip(VideoChat.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),elfocus(VideoChat.replyInput),!0):void 0}}),VideoChat.messageSending=!0}},sendSticker:function(e){var i=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:i.oid,video_id:i.vid,hash:i.hash},{onDone:function(){VideoChat.appendSticker(e,vk.id,!1)}})},deleteMessage:function(e,i){var t=ge("mv_chat_msg"+e);addClass(t,"_deleting"),ajax.post("al_video.php?act=delete_comment",{comment:e,hash:i,videoview_chat:1},{onDone:function(e){val(domByClass(t,"mv_chat_message_content"),e)}})},isHidden:function(){return!!this.hidden||Videoview.isMinimized()},setHidden:function(e){this.hidden=e},toggle:function(){var e=VideoChat.isHidden();this.setHidden(!e),VideoChat.toggleStateClasses(),e&&VideoChat.scroll&&(VideoChat.appendMessagesBatch(),VideoChat.updateScroll()),e||VideoChat.removeStickers()},toggleStateClasses:function(){var e=!!this.block,i=VideoChat.isHidden(),t=Videoview.isMinimized();toggleClass("mv_box","_has_chat",e&&!t),toggleClass("mv_box","_hide_chat",e&&!t&&i);var o="";e&&(VideoChat.appendMessagesBatch(),o=getLang(i?"video_aria_expand_chat":"video_aria_minimize_chat")),attr("mv_top_pl_toggle","aria-label",o)},updateScroll:function(){VideoChat.scroll.update(),VideoChat.scroll.scrollBottom(),VideoChat.toggleScrollBottomBtn(!1)},onResize:function(){VideoChat.block&&(VideoChat._chatHeight=VideoChat.block.offsetHeight)},getHeight:function(){return VideoChat.block?VideoChat._chatHeight||(VideoChat._chatHeight=VideoChat.block.offsetHeight):0},destroy:function(){if(VideoChat.block){if(VideoChat.scroll&&(VideoChat.scroll.destroy(),VideoChat.scroll=null),VideoChat.replyForm){var e=data(VideoChat.replyForm,"optId");e&&Emoji.destroy(e),removeData(VideoChat.replyForm),removeData(VideoChat.replyInput),VideoChat.replyForm=VideoChat.replyInput=null}VideoChat.removeStickers(),removeData(VideoChat.block),re(VideoChat.block),VideoChat.block=null,VideoChat.messagesWrap=null,VideoChat.stickersWrap=null,VideoChat.options=null,clearTimeout(VideoChat._appendMessageTimeout),clearTimeout(VideoChat._appendStickerTimeout),VideoChat._appendMessageTimeout=null,VideoChat._appendStickerTimeout=null,VideoChat._messagesBatch=null,VideoChat.firstMsgIntro=null,VideoChat.messageSending=!1,VideoChat.toggleStateClasses()}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,i){var t=[],o=!0,a=!1,n=void 0;try{for(var r,d=e[Symbol.iterator]();!(o=(r=d.next()).done)&&(t.push(r.value),!i||t.length!==i);o=!0);}catch(s){a=!0,n=s}finally{try{!o&&d["return"]&&d["return"]()}finally{if(a)throw n}}return t}return function(i,t){if(Array.isArray(i))return i;if(Symbol.iterator in Object(i))return e(i,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_video_donate=__webpack_require__(9),_video_donate2=_interopRequireDefault(_video_donate),_video_playlist=__webpack_require__(8),_video_playlist2=_interopRequireDefault(_video_playlist),_video_chat=__webpack_require__(4),_video_chat2=_interopRequireDefault(_video_chat),_video_initializer=__webpack_require__(1),_video_initializer2=_interopRequireDefault(_video_initializer),_player_callback=__webpack_require__(6),_player_callback2=_interopRequireDefault(_player_callback),_moder_actions=__webpack_require__(2),_moder_actions2=_interopRequireDefault(_moder_actions),_dom=__webpack_require__(7);exports["default"]={FLASH_MIN_VERSION:24,isFS:!1,playerCallback:_player_callback2["default"],moderActions:_moder_actions2["default"],cleanUpStoredVSegs:function(){if(window.localStorage){var e=vkNow();for(var i in window.localStorage)if(0===i.indexOf("vsegs")){var t=localStorage.getItem(i);t=JSON.parse(t),e-t.ts>1728e5&&localStorage.removeItem(i)}}},getVideoModule:function(e){var i=cur.currentModule?cur.currentModule():cur.module;return window.Video&&Video.isInVideosList()&&(i=cur.oid<0?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos"),"feed"==i&&"feed_block"==_video_playlist2["default"].getCurListId()&&(i="feed_block"),"feed"==i&&"videos"==cur.section&&(i="feed_videos"),"feed"==i&&"live"==cur.section&&(i="feed_live"),i},showPlaylist:function(){_video_playlist2["default"].toggle(!0)},sendPlayerStats:function(e,i){ajax.post("al_video.php?act=a_player_stat",{action:e,type:i})},removeVideo:function(){var e=Videoview.getMvData();e&&e.deleteFromAllAlbumsHash&&(ajax.post("al_video.php?act=a_delete_from_all_albums",{vid:e.vid,oid:e.oid,target_id:vk.id,hash:e.deleteFromAllAlbumsHash}),e.playlists&&each(e.playlists,function(e,i){i.added=!1}),window.mvcur&&Videoview.initAddButton(),e.added=!1,removeClass(geByClass1("mv_finish_add","mv_external_finish"),"selected"))},getNextVideosData:function(){return _video_playlist2["default"].getNextVideos().slice(0,3)},getSuggestionsData:function(){var e=Videoview.getMvData();return e&&e.playerSuggestions||[]},getMvData:function(){return cur.mvOpts||window.mvcur&&mvcur.mvData},getPlayerObject:function(){return window.mvcur&&mvcur.player||cur.videoInlinePlayer||ge("video_yt")&&window.VideoYoutube||null},getPlayerObjectEl:function(){return ge("video_player")||ge("html5_player")||geByClass1("extra_player")||null},playerOnAdded:function(){var e=Videoview.getPlayerObject();e&&e.onAdded&&e.onAdded()},playerOnLiked:function(){var e=Videoview.getPlayerObject();e&&e.onLiked&&e.onLiked()},playerOnResize:function(){mvcur.player&&mvcur.player.resize(),ge("video_yt")&&window.VideoYoutube&&window.VideoYoutube.onResize()},playerNextTimerUpdate:function(){var e=void 0;mvcur.scrolledAway||mvcur.replyFormShown||"visible"!=document.visibilityState||curBox()?(e="nextTimerReset",mvcur.nextTimerStopped=!0):(e="nextTimerStart",mvcur.nextTimerStopped=!1),mvcur.playerPrevTimerFunc!=e&&(mvcur.playerPrevTimerFunc=e,clearTimeout(mvcur.playerTimerDebounce),mvcur.playerTimerDebounce=setTimeout(function(){var i=Videoview.getPlayerObject();i&&i[e]&&i[e](),mvcur.nextTimer&&mvcur.nextTimer[e]&&mvcur.nextTimer[e]()},0))},togglePlay:function(e,i){if(ge("video_yt")&&window.VideoYoutube)VideoYoutube.togglePlay(e);else if(window.mvcur&&mvcur.player||cur.videoInlinePlayer){var t=window.mvcur&&mvcur.player||cur.videoInlinePlayer,o=t.isAutoplay();(!o||i)&&t.togglePlay(e)}else{var a=ge("video_player");a&&a.playVideo&&a.playVideo(e)}},sendVideoAdStat:function(e,i,t){if(cur._vadStatQueue&&cur._vadStatQueue[e+"_"+i]){var o=cur._vadStatQueue[e+"_"+i],a="undefined"!=typeof cur.vSearchPos&&null!==cur.vSearchPos;o.events.length&&(ajax.post("al_video.php",{act:"ads_stat",ev:o.events.join(","),ad_type:o.type,hash:t,oid:e,vid:i,err:o.err,pl_type:o.pl_type,from_search:a}),o.events=[])}},subscribeToAuthor:function(e,i){function t(){toggleClass("mv_subscribe_block","mv_state_subscribed",e),ajax.post("al_video.php?act=a_subscribe",{author_id:o.authorId,video:o.videoRaw,hash:o.subscribeHash,unsubscribe:intval(!e),from:i||"videoview"},{}),o.subscribed=e;var t=Videoview.getPlayerObject();t&&t.onSubscribed&&t.onSubscribed(e);var a=ge("mv_finish_subscribe_btn");a&&(val(a,getLang(e?"video_view_subscribed_msg":"video_view_subscribe_to_author")),toggleClass("mv_finish_subscribe","mv_finish_subscribed",e))}var o=Videoview.getMvData();if(e||!o.isClosedGroup&&!o.isFriend)t();else{var a=void 0,n=void 0;o.isFriend?(a=getLang("video_unfollow_friend_title"),n=getLang("video_unfollow_friend_text")):(a=getLang("video_leave_closed_group_title"),n=o.adminLevel>2?getLang("video_leave_admined_group_text"):getLang("video_leave_closed_group_text"));var r=function(){curBox().hide(),t()};showFastBox(a,n,getLang("box_yes"),r,getLang("box_no")),Videoview.playerNextTimerUpdate()}},subscribeLive:function(e,i){var t=Videoview.getMvData(),o=!t.liveNotifySubscribed;ajax.post("al_video.php?act=a_subscribe_live",{owner_id:t.authorId,subscribe:intval(o),hash:i}),t.liveNotifySubscribed=!t.liveNotifySubscribed,toggleClass(e,"mv_subscribe_live_btn_subscribed",o),Videoview.onSubscribeLiveOver(e),window.tooltips&&e.tt&&tooltips.rePositionTT(e.tt)},onSubscribeLiveOver:function(e){var i=Videoview.getMvData();showTooltip(e,{text:function(){return getLang(i.liveNotifySubscribed?"video_live_notify_subscribed":"video_live_notify_unsubscribed")},black:1,shift:[0,10,0],needLeft:1})},showDonateBox:function(){var e=Videoview.getMvData();e&&showBox("al_video.php?act=donate_box",{video:e.videoRaw},{onDone:function(e,i){_video_donate2["default"].init(i)},params:{hideButtons:1,onDestroy:_video_donate2["default"].onDestroy},stat:["videoview.css","tooltips.js","tooltips.css"]})},slideLiveGifts:function(e,i,t){var o=ge("mv_live_gifts_list"),a=o.scrollWidth,n=domPN(o).clientWidth;e=e||1,i=Math.abs(i)||n-180;var r=intval(domData(o,"pos"));r+=0>e?-i:i,r=Math.max(0,Math.min(a-n,r)),domData(o,"pos",r),toggleClass(o,"animated",!t),setStyle(o,{"-webkit-transform":"translateX(-"+r+"px)","-ms-transform":"translateX(-"+r+"px)",transform:"translateX(-"+r+"px)"}),Videoview.onLiveGiftsScroll()},onLiveGiftsMouseWheel:function(e){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||(e.preventDefault(),Videoview.slideLiveGifts(e.deltaX,e.deltaX,!0))},onLiveGiftsScroll:function(){var e=ge("mv_live_gifts_list");if(e){var i=domPN(e),t=e.scrollWidth,o=domPN(e).clientWidth,a=intval(domData(e,"pos"));a>t-o&&(Videoview.slideLiveGifts(1,1,1),a=intval(domData(e,"pos")));var n=a>0,r=t>a+o,d=domByClass(i,"mv_live_gifts_arrow_left"),s=domByClass(i,"mv_live_gifts_arrow_right");toggleClass(d,"hidden",!n),toggleClass(s,"hidden",!r),mvcur.liveGiftTT&&mvcur.liveGiftTT.hide()}},getLiveBalanceStr:function(){var e=void 0;return e=mvcur.mvData.paymentsInMoney?getLang("global_money_amount_rub",vk.balance*vk.vcost,!0):getLang("global_n_votes",vk.balance,!0),langStr(getLang("video_live_you_have_X_money"),"money",e)},showLiveGiftTooltip:function(e){if(!data(e,"ett")){Videoview.checkLiveGiftItemVisibility(e);var i=domData(e,"id"),t=domData(e,"price"),o=domData(e,"price-str"),a=domData(e,"free-left"),n=getTemplate("video_live_gift_popup",{gift_id:i,image:"/images/gift/"+i+"/256.png",price:t,price_str:o,balance_str:a||Videoview.getLiveBalanceStr()});addClass(e,"active");var r=mvcur.liveGiftTT=new ElementTooltip(e,{cls:"feature_intro_tt mv_live_gift_popup_tt",content:n,width:230,autoShow:!1,appendTo:domClosest("mv_live_gifts_block",e),offset:[0,14],onBeforeHide:function(){removeClass(e,"active")},onHide:function(){r.destroy()}});r.show()}},checkLiveGiftItemVisibility:function(e){var i=ge("mv_live_gifts_list"),t=domPN(i),o=e.getBoundingClientRect(),a=t.getBoundingClientRect(),n=32;if(o.left<a.left+n){var r=o.left-a.left-n;Videoview.slideLiveGifts(-1,r,!0)}else if(o.right>a.right-n){var d=o.right-a.right+n;Videoview.slideLiveGifts(1,d,!0)}},sendLiveGift:function(e,i,t){return Videoview.liveDonateCheckVotes(i)?void mvcur.liveGiftTT.hide():(ajax.post("al_video.php?act=live_send_gift",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,gift_id:e,hash:t},{onDone:function(i,t){if(updateMoney(i),t){var o=domByClass("mv_live_gifts_block","mv_live_gifts_item_"+e);each(t,function(e,i){e=e.replace(/_/g,"-"),domData(o,e,i)})}},onFail:function(e){return e?(showFastBox(getLang("global_error"),e),!0):void 0}}),void mvcur.liveGiftTT.hide())},showLiveSuperMessageTooltip:function(e){if(!data(e,"ett")){addClass(e,"active");var i=getTemplate("video_live_super_message_popup",{message:mvcur.liveSuperMessageDraft||""}),t=mvcur.liveGiftTT=new ElementTooltip(e,{cls:"feature_intro_tt mv_live_gift_popup_tt",content:i,width:230,autoShow:!1,appendTo:domClosest("mv_live_gifts_block",e),offset:[0,14],onBeforeHide:function(){removeClass(e,"active")},onHide:function(){t.destroy()}});t.show(),elfocus("mv_live_gift_popup_comment_input")}},checkLiveSuperMessageLength:function(e,i){var t=trim(val(e)),o=intval(domData(e,"maxlength"));mvcur.liveSuperMessageDraft=t;var a=t.length>o,n=domNS(e),r=domNS(n);toggle(n,!a),toggle(r,a),i&&n.click()},onLiveSuperMessageCtrlEnter:function(){var e=ge("mv_live_gift_popup_comment_input");Videoview.checkLiveSuperMessageLength(e,!0)},sendLiveSuperMessage:function(e,i){var t=ge("mv_live_gift_popup_comment_input"),o=trim(val(t));return o?Videoview.liveDonateCheckVotes(e)?void mvcur.liveGiftTT.hide():(ajax.post("al_video.php?act=live_send_super_message",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,message:o,hash:i},{onDone:function(e,i){updateMoney(e),delete mvcur.liveSuperMessageDraft},onFail:function(e){return e?(showFastBox(getLang("global_error"),e),!0):void 0}}),void mvcur.liveGiftTT.hide()):void notaBene(t)},liveDonateCheckVotes:function(e){return vk.balance<e?showBox("al_gifts.php?act=get_money"):!1},onStickersPurchased:function(e){var i=Videoview.getPlayerObject();i&&i.onStickersPurchased&&i.onStickersPurchased(e);
},addPlaylist:function addPlaylist(onlyPrivate){showBox("al_video.php?act=add_playlist_box",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,only_private:onlyPrivate?1:0,hash:mvcur.mvData.addedVideoHash},{onDone:function onDone(box){box.removeButtons(),box.addButton(getLang("Save"),function(btn){var title=trim(val("mv_video_playlist_edit_title")),privacy=Privacy.getValue("video_playlist");title&&ajax.post("al_video.php?act=a_save_playlist",{title:title,privacy:privacy,hash:val("video_playlist_edit_hash"),oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{showProgress:lockButton.pbind(btn),hideProgress:unlockButton.pbind(btn),onDone:function onDone(playlistId,text,playlist,video){curBox().hide(),text&&showDoneBox(text),mvcur.mvData.playlists.push({id:playlistId,added:!0,title:clean(title),"private":intval(privacy)}),Videoview.initAddButton(),window.Video&&playlist&&(playlist=eval("("+playlist+")"),Video.updateAlbum(playlistId,!1,playlist),video&&(video=eval("("+video+")"),Video.updateVideo(vk.id,video,[],!1,[playlistId])))}})})},stat:["privacy.js","privacy.css","video.js","video.css"]}),Videoview.playerNextTimerUpdate()},updateVideo:function(e,i,t,o,a){window.mvcur&&mvcur.mvData.oid==e&&mvcur.mvData.vid==i&&(mvcur.mvData.title=t,mvcur.mvData.desc=o,Videoview.setTitle(),Videoview.setDesc(),a&&mvcur.mvShown&&Videoview.reload())},setAddButtonStateAdded:function(){window.mvcur&&mvcur.mvShown&&(mvcur.mvData.published=!0,triggerEvent("mv_add_button","setAdded"))},initAddButton:function(){function e(){mvcur.addButtonTT=mvcur.addButtonTT||new ElementTooltip(n,{cls:"mv_add_eltt",elClassWhenShown:"mv_no_active",autoShow:!0,noHideOnClick:!0,onFirstTimeShow:function(e){function i(e){var i=mvcur.addButtonTT.getContent();toggleClass(i,"mv_add_eltt_add_playlist_hover",e)}var t="";each(mvcur.mvData.playlists,function(e,i){var o=i["private"]?'<span class="mv_tt_playlist_private_icon" onmouseover="showTooltip(this, { black: 1, text: \''+getLang("video_album_is_private_tt")+"', shift: [16, 8, 0] })\"></span>":"";t+='\n              <div class="mv_tt_playlist">\n                <div class="checkbox '+(i.added?"on":"")+" "+(i.disabled?"disabled":"")+'" data-id="'+i.id+'" onclick="checkbox(this);">'+i.title+"</div>\n                "+o+"\n              </div>\n            "}),t='\n            <div id="mv_pl_tt">\n              <div class="mv_tt_private_only '+(s?"":"unshown")+'">'+getLang("video_only_private_video")+'</div>\n              <div class="mv_tt_playlists '+(s?" with_border":"")+'">\n                '+t+'\n              </div>\n              <div class="mv_tt_add_playlist" role="link" tabindex="0" onclick="Videoview.addPlaylist('+s+')">\n                <span class="mv_tt_plus_icon"></span>'+getLang(s?"video_add_private_album":"video_add_album")+"\n              </div>\n            </div>\n          ",val(e,t),each(geByClass("checkbox",e),function(){addEvent(this,"click",a)});var o=domByClass(e,"mv_tt_add_playlist");addEvent(o,"mouseenter",i.pbind(!0)),addEvent(o,"mouseleave",i.pbind(!1)),window.updateAriaCheckboxes()},onDestroy:function(e){e&&(each(geByClass("checkbox",e),function(){removeEvent(this)}),removeEvent(domByClass(e,"mv_tt_add_playlist")))}})}function i(e,i,o){e=d||e;var s=geByClass1("mv_added_icon",n),v=geByClass1("mv_plus_icon",n),c=geByClass1("mv_add_text",n);toggleClass(v,"mv_add_icon_curr",!e),toggleClass(v,"mv_add_icon_down",e),toggleClass(s,"mv_add_icon_curr",e),removeEvent(n,"click",t),removeEvent(n,"setAdded",t),e?(c.innerHTML=getLang("video_added_to_my_playlist"),i&&a(!1,r.PLAYLIST_ADDED_ID)):(c.innerHTML=getLang("video_add_to_my_playlist"),addEvent(n,"click",t),addEvent(n,"setAdded",t)),o||l==e||Videoview.playerOnAdded(),l=e,r.added=e}function t(e){"click"==e.type&&isAncestor(e.target,mvcur.addButtonTT.getContent())||(Videoview._isCurrentVideoPublished()?s&&"click"==e.type||i(!0,!0,"setAdded"==e.type):Videoview.showAddDialog(mvcur.videoRaw))}function o(){var e=!1;return each(mvcur.mvData.playlists,function(i,t){return t.added?(e=!0,!1):void 0}),e}function a(e,t){var a=!0;if(e){var n=e.currentTarget||e.target;if(hasClass(n,"disabled"))return;a=isChecked(n),t=+n.getAttribute("data-id")}else mvcur.addButtonTT.getContent()&&each(geByClass("checkbox",mvcur.addButtonTT.getContent()),function(){return domData(this,"id")==t?(checkbox(this),!1):void 0});each(mvcur.mvData.playlists,function(e,i){return i.id==t?(i.added=a,!1):void 0}),ajax.post("al_video.php?act=a_add_to_playlist",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,hash:mvcur.mvData.playlistAddHash,playlist_id:t,add:+a,info:window.Video&&Video.isInCatalog()?_video_playlist2["default"].getCurListId():""},{onDone:function(e){var i=[],o=[];if(a){i.push(t);var n=e.indexOf(t);e.splice(n,1)}else o.push(t),e.push(t);mvcur.mvData.info&&window.Video&&!Video.isInCatalog()&&Video.updateVideo(vk.id,mvcur.mvData.info,e,!1,i,o)}}),e&&(i(o()),cancelEvent(e))}mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null);var n=ge("mv_add_button");if(n){var r=Videoview.getMvData(),d=r.uploaded,s=r.noPublicAdd,l=!1;i(d||o(),!1,!0),e()}},locNav:function(e,i,t){t=nav.toStr(t);var o=t.match(/^video(-?\d+_\d+)$/);return o?void 0:void Videoview.hide()},showPlayer:function(e){var i=ge("video_player");i&&(e||!i.getAttribute("preventhide")||browser.safari_mobile)&&(browser.msie&&setStyle(i,{position:"static",top:0}),browser.safari_mobile?show(i):i.style.visibility="visible")},hidePlayer:function(e){var i=ge("video_player");i&&(e||!i.getAttribute("preventhide")||browser.safari_mobile)&&(browser.msie&&setStyle(i,{position:"absolute",top:"-5000px"}),browser.safari_mobile?hide(i):i.style.visibility="hidden")},init:function(){window.mvcur={},window.mvLayer||(window.mvLayer=ce("div",{id:"mv_layer"}),addEvent(window.mvLayer,"mousemove",function(){mvcur.mousemoved=!0,mvcur.blackout&&Videoview.moveCheck()}),window.mvLayerWrap=ce("div",{id:"mv_layer_wrap",className:"fixed layer_wrap"}),mvLayerWrap.appendChild(window.mvLayer),bodyNode.appendChild(mvLayerWrap),setStyle(window.mvLayer,{width:lastWindowWidth-sbWidth()-2+"px"}),addEvent(mvLayerWrap,"scroll",Videoview.viewScroll))},moveCheck:function(){mvcur.mousemoved?mvcur.blackout&&(mvcur.blackout=!1,isVisible(window.layerBG)?animate(window.layerBG,{opacity:.8},200):setStyle(window.layerBG,{opacity:.8})):mvcur.blackout||mvcur.finished||!isVisible(window.layerBG)||(mvcur.blackout=!0,animate(window.layerBG,{opacity:.9},5e3)),mvcur.mousemoved=!1},show:function(e){function i(i,t,o,a){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(e,i,t,o){var a=window.ap;a&&a.isPlaying()&&(a.pause(),a.pausedByVideo=vkNow()),o&&o.autoplay&&Videoview.playerCallback.onVideoStreamPlaying(),debugLog("show video "+i);var n=window.mvcur&&mvcur.mvShown,r=window.mvcur&&mvcur.player;if(n&&(r&&domPN(r.el)===ge("video_player")?r.deinitVideo():(val("mv_player_box",""),hide("mv_player_box"),show("mv_progress_box"))),window.mvcur&&clearInterval(mvcur.nextTimerUpdateInterval),window.mvcur&&mvcur.minimized){if(!o.nomin)return mvcur.videoRaw=i,mvcur.options=o,mvcur.listId=t,mvcur.mvData=!1,o.playlistId?Videoview.initPlaylistBlock(i,o.playlistId,o.catLoadMore):_video_playlist2["default"].removeBlock(),!0;o.prevLoc&&(mvcur.mvPrevLoc=o.prevLoc),debugLog("unminimizing in show"),Videoview.unminimize(!0,!1,!0)}if(o.queue&&(debugLog("pushing in videoview.show"),window.layerQueue.push(),o.queue=!1),!o.noLocChange&&nav.objLoc.z&&0==nav.objLoc.z.indexOf("video")&&(cur.mvHistoryBack=cur.mvHistoryBack||1,cur.mvHistoryBack++),window.forcePauseAudio=!0,n||window.layerQueue.hide(),window.forcePauseAudio=!1,this.init(),mvcur.showTime=(new Date).getTime(),removeEvent(window,"resize",Videoview.onResize),removeEvent(window,"focus blur",Videoview.onPageFocusChange),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),addEvent(window,"resize",Videoview.onResize),addEvent(window,"focus blur",Videoview.onPageFocusChange),addEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),addEvent(document,"keydown",Videoview.onKeyDown),window.boxQueue.hideAll(),layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide,mvcur.nextTimerUpdateInterval=setInterval(Videoview.playerNextTimerUpdate,1e3),setTimeout(function(){layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide},0),mvcur.noLocChange=0,o.ad_video&&(o.hideInfo=1,o.noLocChange=1,mvcur.noLocChange=1,mvcur.videoAds=1),mvcur.noHistory=o.noLocChange||o.noHistory,mvcur.blackInterval=setInterval(Videoview.moveCheck,18e4),mvcur.videoRaw=i,mvcur.options=o,mvcur.listId=t,mvcur.mvData=!1,mvcur.mvShown=!0,mvcur.player=r,o.prevLoc?mvcur.mvPrevLoc=o.prevLoc:setTimeout(function(){var e=document.URL;Videoview.setLocation(o.noLocChange),e==document.URL&&(e="");var i=window.comScoreUDM;setTimeout(i&&i.pbind(locProtocol+"//"+locHost+"/al_video.php?comscorekw=pageview_candidate",e),10)},0),e&&e.pageX&&e.pageY&&extend(mvcur,{mvOldX:e.pageX,mvOldY:e.pageY,mvOldT:vkNow()}),n?(Videoview.disableLayerContent(),_video_chat2["default"].destroy()):Videoview.buildLayerContent(),toggle("mv_info",!o.hideInfo),o.expandPlayer){mvcur.player=o.expandPlayer,o.expandPlayer=1;var d=domClosest("video_box_wrap",mvcur.player.el);ge("mv_player_box").appendChild(d),hide("mv_progress_box"),show("mv_player_box"),mvcur.player.onExpanded()}return o.playlistId?Videoview.initPlaylistBlock(i,o.playlistId,o.catLoadMore,!n):_video_playlist2["default"].removeBlock(),Videoview.cleanUpStoredVSegs(),o.minimized&&setTimeout(Videoview.minimize.bind(Videoview),0),!1}),buildLayerContent:function(){var e="mv_dark";addClass(window.mvLayerWrap,e),addClass(window.layerBG,e),val(window.mvLayer,'\n  <div class="mv_layer_bg" onclick="Videoview.hide();"></div>\n  <div id="mv_container" class="scroll_fix_wrap">\n    <div id="mv_box">\n      <div id="mv_approve" style="display: none;"></div>\n      <div id="mv_publish" style="display: none;"></div>\n      <div class="mv_min_header">\n        <div class="mv_min_control" onmousedown="return Videoview.hide(false, true);" role="button" tabindex="0" aria-label="'+getLang("global_close")+'">\n          <div class="mv_min_control_close"></div>\n        </div>\n        <div class="mv_min_control" onclick="return Videoview.unminimize();">\n          <div class="mv_min_control_max"></div>\n        </div>\n        <div class="mv_min_title" id="mv_min_title"></div>\n      </div>\n      <div id="mv_main" class="mv_main">\n        <div class="mv_pl_prev_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_prev" onclick="return VideoPlaylist.prevVideo()">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div class="mv_pl_next_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_next" onclick="return VideoPlaylist.nextVideo()">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div id="mv_progress_box">'+getProgressHtml()+'</div>\n        <div id="mv_player_box"></div>\n        <div class="mv_top_controls_wrap">\n          <div id="mv_top_controls">\n            <div onclick="return Videoview.hide(false, true, event, true);" class="mv_top_button mv_top_close" role="button" tabindex="0" aria-label="'+getLang("global_close")+'">\n              <div class="mv_close_icon"></div>\n            </div>\n            <div onclick="return Videoview.minimize(event);" class="mv_top_button mv_top_minimize">\n              <div class="mv_minimize_icon"></div>\n            </div>\n            <div onclick="return Videoview.toggleSideBlock(event);" class="mv_top_button mv_top_toggle_sideblock" id="mv_top_pl_toggle" role="button" tabindex="0">\n              <div class="mv_toggle_sideblock_icon"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div id="mv_moder_buttons_wrap">\n        <div id="mv_moder_buttons"></div>\n      </div>\n      <div class="mv_info" id="mv_info"></div>\n      <div id="mv_warning" style="display: none;"></div>\n    </div>\n  </div>\n    '),Videoview.updateSize()},disableLayerContent:function(){addClass("mv_info","mv_info_disabled")},initPlaylistBlock:function(e,i,t,o){if(-127333786!=e.split("_")[0]){var a=!!_video_playlist2["default"].getBlock(),n=_video_playlist2["default"].buildBlock(i,e,o);if(n&&/^wall_/.test(i)&&_video_playlist2["default"].lists[i]&&cur.wallVideos&&cur.wallVideos[i]&&(_video_playlist2["default"].extendList(i,cur.wallVideos[i].list),_video_playlist2["default"].updateBlockList(i)),n){ge("mv_main").appendChild(n);var r=_video_playlist2["default"].getCurList().list.length;(window.Video&&Video.isInVideosList()&&vk.id==cur.oid||5>r)&&(a||_video_playlist2["default"].toggle(!1)),isFunction(t)&&t(_video_playlist2["default"].updateBlockList.pbind(i)),setTimeout(function(){_video_playlist2["default"].restoreScrollPos(),_video_playlist2["default"].updateScrollbar(),_video_playlist2["default"].setCurVideo(e,a)},0)}_video_playlist2["default"].toggleStateClasses(),_video_playlist2["default"].updateControls()}},hide:function(e){function i(i,t,o,a){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(e,i,t,o){if(window.mvcur&&(i||mvcur.mvShown)){if(o){var a=cur.videoBackOnClick;if(cur.videoBackOnClick=!1,a)return history.back()}if(!i&&mvcur.minimized)return void(mvcur.noLocChange||e===!0||(2===e?nav.setLoc(window.hab.getLoc()):window.layerQueue.count()||Videoview.backLocation()));if(!mvcur.noHistory&&!e&&!o){mvcur.noHistory=1,mvcur.forceHistoryHide=i,window.__adsUpdate("very_lazy");var n=cur.mvHistoryBack?-cur.mvHistoryBack:-1;return cur.mvHistoryBack=0,setTimeout(function(){mvcur.mvShown||(Videoview.destroyPlayer(),_video_playlist2["default"].removeBlock())},10),history.go(n)}if(mvcur.forceHistoryHide&&(i=mvcur.forceHistoryHide,mvcur.forceHistoryHide=!1),mvcur.statusVideo){var r=ge("mv_like_icon");if(r){var d=r.parentNode.tt;d&&d.container&&re(d.container),r.parentNode.tt&&delete r.parentNode.tt}}var s=mvcur.minimized;if(s&&(Videoview.unminimize(!0,!0,!0),mvcur.minimized=!1,e=!0),Wall.cancelEdit(!0),mvcur.replyFormShown&&Wall.hideEditReply(mvcur.post),(mvcur.mvData.duration>60||mvcur.mvData.is_live)&&!i&&!mvcur.finished){var l=(new Date).getTime()-mvcur.showTime,v=getLang("video_are_you_sure_close");if(l>3e4&&"are you sure close"!=v&&!browser.safari_mobile){var c=showFastBox({title:getLang("video_are_you_sure_close_title"),bodyStyle:"padding: 20px; line-height: 160%;",forceNoBtn:1},v,getLang("box_yes"),function(){c.hide(),Videoview.hide(e,!0)},getLang("box_no")),u=function(i){13==i.keyCode&&(c.hide(),Videoview.hide(e,!0))};return addEvent(document,"keydown",u),c.onHide=function(){removeEvent(document,"keydown",u)},!0}}if(cur.vSearchPos&&delete cur.vSearchPos,cur.vSearchLastActionTime&&(cur.vSearchLastActionTime=(new Date).getTime()),mvcur.finished||Videoview.logViewedPercentage(),!window.forcePauseAudio){var m=window.ap;m&&!m.isPlaying()&&m.pausedByVideo&&(vkNow()-m.pausedByVideo<18e4&&m.play(),delete m.pausedByVideo),window.Notifier&&Notifier.lcSend("video_hide")}s?hide(mvLayerWrap):(layers.wraphide(mvLayerWrap),layers.fullhide=!1),window.tooltips&&tooltips.destroyAll(cur.mvBox);var _="mv_dark";return removeClass(mvLayerWrap,_),removeClass(window.layerBG,_),mvcur.mvShown=!1,removeEvent(window,"resize",Videoview.onResize),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),clearInterval(mvcur.nextTimerUpdateInterval),mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null),Videoview.removeExternalVideoFinishBlock(),Videoview.destroyPlayer(),val("mv_player_box",""),s&&isVisible(layerWrap)||(debugLog("pop from videoview.hide"),setTimeout(window.layerQueue.pop,0)),mvcur.blackInterval&&clearInterval(mvcur.blackInterval),o&&nav.objLoc.z?(window.layerQueue.skipVideo=!0,delete nav.objLoc.z,nav.setLoc(nav.objLoc)):mvcur.noLocChange||e===!0||(2===e?nav.setLoc(window.hab.getLoc()):Videoview.backLocation(),window.__adsUpdate("very_lazy")),window.__adsUpdate(),mvcur.bodyScrollTop=window.scrollNode.scrollTop,setTimeout(function(){void 0!==mvcur.bodyScrollTop&&(window.scrollNode.scrollTop=mvcur.bodyScrollTop,delete mvcur.bodyScrollTop)},0),!1}}),destroyPlayer:function(){mvcur.player&&(mvcur.player.destroy(),delete mvcur.player),ge("video_yt")&&window.VideoYoutube&&window.VideoYoutube.destroy()},cmp:function(e,i){var t=e.length,o=i.length;return o>t?-1:t>o?1:i>e?-1:e>i?1:0},onKeyDown:function(e){return e.returnValue===!1?!1:e.keyCode==KEY.ESC?(mvcur.mvEditing?Videoview.cancelInline():Videoview.hide(),cancelEvent(e)):void 0},onResize:function(){Videoview.updateExternalVideoFinishBlock(),Videoview.updateReplyFormPos(),Videoview.onLiveGiftsScroll(),_video_chat2["default"].onResize()},onPageFocusChange:function(){setTimeout(Videoview.playerNextTimerUpdate,10)},onFullscreenChange:function(){Videoview.updateExternalVideoFinishBlock(),mvcur.chatMode&&(_video_chat2["default"].onResize(),_video_chat2["default"].updateScroll())},updateSize:function(){if(mvcur.minimized)return!1;var e=document.documentElement,i=window.innerHeight||e.clientHeight||bodyNode.clientHeight,t=2;isVisible("mv_info")||(t=1.2),setStyle("mv_container",{marginTop:Math.max((i-800)/t,60)+"px"}),window.onBodyResize(),Videoview.onResize()},getPrevLoc:function(){mvcur.mvPrevLoc={};for(var e in nav.objLoc)("z"!=e||0!=!nav.objLoc[e].indexOf("video"+mvcur.videoRaw))&&(mvcur.mvPrevLoc[e]=nav.objLoc[e])},setLocation:function(e){if(mvcur.options.fromPreload){var i=mvcur.listId.match(/([a-z]*)([0-9\-]*)/),t=mvcur.listId.match(/claim=([0-9]+)/),o=parseInt(i[2]);mvcur.mvPrevLoc={0:"videos"+o},"videos"!=i[1]&&(mvcur.mvPrevLoc.section=i[1]),t&&t[1]&&(mvcur.mvPrevLoc.claim=t[1])}else e?mvcur.mvPrevLoc="z":Videoview.getPrevLoc();if(!e){var a="video"+mvcur.videoRaw;mvcur.listId&&(a+="/"+mvcur.listId),mvcur.options.playlistId&&(a+="/pl_"+mvcur.options.playlistId);var n=extend(nav.objLoc,{z:a});/^video-?\d+/.test(nav.objLoc[0])&&(n[0]="videos"+cur.oid),nav.strLoc!=nav.toStr(n)&&(nav.setLoc(n),(mvcur.options||{}).fromQueue&&(mvcur.noHistory=1)),mvcur.options&&(mvcur.options.fromQueue=!1)}},backLocation:function(){if("z"==mvcur.mvPrevLoc||!mvcur.mvPrevLoc&&nav.objLoc.z){var e=clone(nav.objLoc);delete e.z,nav.setLoc(e)}else mvcur.mvPrevLoc?nav.setLoc(mvcur.mvPrevLoc):("video"==nav.objLoc[0]||nav.objLoc[0].match(/^video-?\d+_\d+/))&&nav.setLoc({0:"video"});mvcur.options.prevTitle&&((0,_dom.setDocumentTitle)(replaceEntities(stripHTML(mvcur.options.prevTitle))),delete mvcur.options.prevTitle),mvcur.noHistory=1},highlightComment:function(e){if(e=ge(e)){var i=animate.pbind(e,{backgroundColor:"#eceff3"},200,function(){setTimeout(function(){animate(e,{backgroundColor:"#fff"},200)},1e3)}),t=getXY(e,!0)[1];if(0>t||t>lastWindowHeight-200){var o=mvLayerWrap.scrollTop+t-50;animate(mvLayerWrap,{scrollTop:o},300,i)}else i()}},showComment:function(e){var i=ge("post"+e);return i?Videoview.highlightComment(i):Videoview.moreComments(e),!1},commActionDone:function commActionDone(commId,from,text,del,script){var node=ge("post"+commId.split("_").join("video_")+from);if(node){var comment=domByClass(node,"reply_wrap"),msg=domByClass(node,"dld");if(!text)return re(msg),show(comment),"mv"==from?(++mvcur.mvData.commcount,++mvcur.mvData.commshown):(++cur.commentsCount,++cur.commentsShown),void Videoview.updateCommentsHeader(from);hide(comment),node.appendChild(se(text)),del?("mv"==from?(--mvcur.mvData.commcount,--mvcur.mvData.commshown):(--cur.commentsCount,--cur.commentsShown),Videoview.updateCommentsHeader(from)):"mv"==from&&Videoview.recache(),script&&eval(script),Videoview.updateReplyFormPos()}},commAction:function(e,i,t,o,a){var n=ge("post"+i+"video_"+t+a),r=domByClass(n,"post_actions"),d=ge("reply_"+e+i+"video_"+t+a);attr(n,"data-action",e),d&&tooltips.hide(d),ajax.post("al_video.php",{act:e+"_comment",comment:i+"_"+t,hash:o,videoview:1,from:a},{onDone:Videoview.commActionDone.pbind(i+"_"+t,a),showProgress:addClass.pbind(r,"post_actions_progress"),hideProgress:removeClass.pbind(r,"post_actions_progress"),stat:["privacy.js","privacy.css"]})},moreComments:function(e){if(isVisible("mv_comments_header")&&!hasClass(domFC(ge("mv_comments_header")),"pr")&&!(e&&Videoview.cmp(domFC(ge("mv_comments")).id,"post"+e)<0)){var i=Videoview.getMvData();ajax.post("al_video.php?act=video_comments",{offset:i.commshown,video:i.videoRaw},{onDone:function(i,t){Videoview.receiveComms(i,t,!0,e),e&&ge("post"+e)&&Videoview.showComment(e)},showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){var e=ge("mv_comments_header");mvcur.mvCommInfo=val(e),val(e,""),showProgress(e)}),hideProgress:function(){val("mv_comments_header",mvcur.mvCommInfo)}})}},updateCommentsHeader:function(e){if("review"!=e){var i=Videoview.getMvData(),t="";i.commcount>i.commshown&&(t=getLang("video_show_previous_comments",i.commcount-i.commshown)),i.commcount&&val("mv_comments_summary",getLang("video_comments_summary",i.commcount)),setStyle("mv_comments_summary",{display:i.commcount?null:"none"}),toggleClass("mv_comments_header","mv_comments_expanded",!t),toggleClass("mv_comments_summary","mv_comments_expanded",!t),val("mv_comments_header",t),Videoview.recache()}},onShowEditReply:function(){mvcur.replyFormShown=!0,Videoview.updateReplyFormPos(),Videoview.playerNextTimerUpdate()},onHideEditReply:function(){mvcur.replyFormShown=!1,mvcur.mvReplyTo=!1,Videoview.updateReplyFormPos(),setTimeout(Videoview.updateReplyFormPos,0),Videoview.playerNextTimerUpdate()},commentClick:function(e,i,t,o){Wall.checkReplyClick(e,i)||(mvcur.mvReplyTo=[t,o],Wall.replyTo(mvcur.post,o,t))},receiveComms:function(e,i,t,o){for(var a=ce("div",{innerHTML:e}),n=ge("mv_comments"),r=Videoview.getMvData(),d=void 0,s=d=domLC(n),l=getXY(d,!0)[1],v=void 0;v=domLC(a);){for(;d&&Videoview.cmp(d.id,v.id)>0;)d=domPS(d);d&&!Videoview.cmp(d.id,v.id)?(n.replaceChild(v,d),d=v):(d&&domNS(d)?n.insertBefore(v,domNS(d)):!d&&domFC(n)?t?n.insertBefore(v,domFC(n)):(--r.commshown,a.removeChild(v)):n.appendChild(v),t||++r.commcount,++r.commshown)}o&&s&&(mvLayerWrap.scrollTop+=getXY(s,!0)[1]-l),extend(mvcur.mvReplyNames,i),window.updateWndVScroll&&window.updateWndVScroll(),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()},commSaved:function(e){},sendComment:function(e,i,t){var o=ge("reply_field"+e),a=o&&data(o,"composer"),n=(mvcur.mvReplyNames[(mvcur.mvReplyTo||{})[0]]||[])[1],r=ge("reply_button"+e),d=void 0;if(t)d={message:"",attach1_type:"sticker",attach1:t};else{if(d=a?Composer.getSendParams(a,Videoview.sendComment):{message:trim(val(o))},d.delayed)return;if(!d.attach1_type&&(!d.message||n&&!n.indexOf(d.message)))return void elfocus(o)}ajax.post("al_video.php?act=post_comment",Wall.fixPostParams(extend(d,{video:mvcur.mvData.videoRaw,hash:mvcur.mvData.hash,fromview:1,videoviewer:1,from_oid:domData(domClosest("_submit_post_box",ge("reply_as_group"+mvcur.post)),"from-oid"),reply_to:(mvcur.mvReplyTo||{})[1]})),{onDone:function(i,t){Videoview.receiveComms(i,t),val("mv_comments_summary",getLang("video_comments_summary",mvcur.mvData.commcount)),Composer.reset(a),hide("reply_warn"+e),Wall.cancelReplyTo(e),mvLayerWrap.scrollTop=9e9},onFail:function(e){return o?(showTooltip(o,{text:e,showdt:200,forcetodown:0,slide:15}),elfocus(o),!0):void 0},showProgress:lockButton.pbind(r),hideProgress:unlockButton.pbind(r)})},activate:function(e,i,t){2==i?animate(e,{color:"#fff"},"undefined"!=typeof t?0:200):animate(e,{opacity:1},200)},deactivate:function(e,i){2==i?animate(e,{color:"#777"},"undefined"!=typeof fast?0:200):animate(e,{opacity:.5},200)},addVideo:function addVideo(videoRaw,hash,obj,gid,accessHash,from){var url=void 0,params=void 0;return window.mvcur&&mvcur.statusVideo?(params={status:videoRaw,hash:hash,from:from||"videoviewer"},url="al_video_external.php?act=external_add"):(params={video:videoRaw,hash:hash,from:from||"videoviewer",module:cur.module||"",info:window.Video&&Video.isInCatalog()?_video_playlist2["default"].getCurListId():""},gid&&(params.gid=gid),url="al_video.php?act=a_add"),accessHash&&(params.access_hash=accessHash),ajax.post(url,params,{onDone:function onDone(text,row,hash,shareHash){if(obj&&val(domPN(obj),text),!isArray(row))try{row=eval("("+row+")")}catch(e){}window.mvcur&&(mvcur.mvData&&mvcur.mvData.afterAdd?mvcur.mvData.afterAdd(row[0]+"_"+row[1],shareHash):row&&(mvcur.mvData.addedVideo=row[0]+"_"+row[1],mvcur.mvData.addedVideoHash=hash,mvcur.mvData.addedVideoShareHash=shareHash));var videoEl=ge("video_cont"+videoRaw);videoEl&&addClass(videoEl,"video_row_added"),"list"==from&&showDoneBox(text),window.Video&&!Video.isInCatalog()&&Video.updateVideo(cur.oid,row,[],!1,[-2]),Videoview.setAddButtonStateAdded()}}),!1},likeUpdate:function(e,i,t,o){i=intval(i);var a=Videoview.getMvData();a.likes=i,a.liked=e;var n=ge("mv_like_wrap"),r=domByClass(n,"_count");if(r){var d=n.tt||{},s=clone(d.opts||{}),l=domByClass(d.container,"_value"),v=domByClass(d.container,"_content"),c=domByClass(d.container,"_title");t&&c&&val(c,t),l&&(l.value=i),animateCount(r,i),toggleClass(n,"my_like",e),toggleClass(n,"no_likes",!i),toggleClass(v,"me_hidden",!e),i?o||!d.el||isVisible(d.container)||t||tooltips.show(d.el,extend(s,{showdt:0})):d.el&&d.hide()}},_isCurrentVideoPublished:function(){var e=Videoview.getMvData();return e&&e.published},addSmall:function(e,i,t,o){if(Videoview._isCurrentVideoPublished()){window.mvcur&&mvcur.mvShown?Videoview.setAddButtonStateAdded():Videoview.addVideo(e,i,!1,t,o),hide("video_add_action_link"),addClass(ge("mv_like_line"),"video_added"),addClass(geByClass1("mv_finish_add","mv_external_finish"),"selected");var a=Videoview.getMvData();a.added=!0}else Videoview.showAddDialog(e)},showAddDialog:function(e){if(cur._recentAddedVideos=cur._recentAddedVideos||{},!cur._recentAddedVideos[e]){var i=Videoview.getMvData();showBox("al_video.php?act=show_add_video_box",{oid:i.oid,vid:i.vid},{onDone:function(t,o){o&&(t.removeButtons(),t.addButton(getLang("Save"),function(t){var a=trim(val("mv_video_add_title"));a&&ajax.post("al_video.php?act=a_add_publish_video",{title:a,video_privacy:Privacy.getValue("video_add"),videocomm_privacy:Privacy.getValue("videocomm_add"),hash:o,oid:i.oid,vid:i.vid},{showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t),onDone:function(){cur._recentAddedVideos[e]=!0,Videoview.hide(!0,!0),Videoview.recache(e),showVideo(e,mvcur.listId)}})}))}})}},share:function(e,i,t){if(vk.id){var o=Videoview.getMvData();return o&&!o.addedVideo&&(o.addedVideo=o.videoRaw),(o||e)&&showBox("like.php?act=publish_box",{object:"video"+(o.addedVideo||e),action_type:t},{onDone:function(){Videoview.isLayerShown()&&Videoview.playerNextTimerUpdate()}}),!1}},like:function(e,i){if(vk.id){var t=Videoview.getMvData();if(t){var o=(window.mvcur&&mvcur.statusVideo?"wall":"video")+t.videoRaw,a="";if(window.Video&&Video.isInCatalog()){var n=_video_playlist2["default"].getCurListId();a=Videocat.isTop3Playlist(n)?"featured":n}ajax.post("like.php?act=a_do_"+(t.liked?"unlike":"like"),{hash:t.likeHash,short_view:1,from:"videoview",object:o,info:a},{onDone:Videoview.likeUpdate.pbind(!t.liked)}),i||Videoview.playerOnLiked(),toggleClass(geByClass1("mv_finish_like","mv_external_finish"),"selected",!t.liked),Videoview.likeUpdate(!t.liked,t.likes+(t.liked?-1:1),null,i),Videoview.recache()}}},likeShare:function(e){if(vk.id){var i=mvcur.mvData,t=(mvcur.statusVideo?"wall":"video")+i.videoRaw,o=ge("like_share_video"+i.videoRaw),a=isChecked(o);checkbox(o),ajax.post("like.php?act=a_do_"+(a?"unpublish":"publish"),{object:t,hash:e,short_view:1,list:mvcur.listId},{onDone:Videoview.likeUpdate.pbind(!0)}),Videoview.likeUpdate(!0,i.likes+(i.liked?0:1))}},likeOver:function(e){var i=mvcur.mvData,t=(mvcur.statusVideo?"wall":"video")+i.videoRaw,o=getSize(ge("mv_like_link")),a=(o?o[0]:20)+2;showTooltip(e,{url:"like.php?act=a_get_stats",params:{object:t,list:mvcur.listId,from:"videoview"},slide:15,shift:[0,8,9],ajaxdt:100,showdt:400,hidedt:200,typeClass:"like_tt",className:"mv_like_tt",dir:"auto",init:function(e){if(e.container){var i=geByClass1("bottom_pointer",e.container,"div"),t=geByClass1("top_pointer",e.container,"div");setStyle(i,{marginLeft:a}),setStyle(t,{marginLeft:a})}}})},likesShowList:function(e){var i=domPN(e),t=domByClass(i,"_icon"),o=Videoview.getMvData();if(t&&!cur.viewAsBox&&o){var a=(mvcur.statusVideo?"wall":"video")+o.videoRaw;showWiki({w:"likes/"+a},!1,!1,{queue:1})}},showEditBox:function(e,i,t,o){showBox("al_video.php?act=edit_box",{vid:e,oid:i,is_publish:+o},{stat:["privacy.js","privacy.css","video.js","video.css"]})},restoreVideo:function(e,i,t,o,a){var n=ge("mv_warning");return n&&(n.innerHTML='<img style="margin-left: 100px;" src="/images/upload.gif" />'),ajax.post("al_video.php?act=restore_video",{vid:e,oid:i,hash:t,from:o||"videoviewer"},{onDone:function(t){if("list"==o&&cur.restoreRaw&&cur.restoreRaw[i+"_"+e]){var a=ge("video_row"+i+"_"+e);val(a,cur.restoreRaw[i+"_"+e]),removeClass(a,"video_row_loading"),removeClass(a,"video_row_deleted"),setStyle(geByClass1("video_row_icon_delete",a),{opacity:.8})}hide("mv_warning"),show("mv_info"),cur.claimedVideoText&&(val("video_player",cur.claimedVideoText),cur.claimedVideoText="")},onFail:function(e){return setTimeout(showFastBox({title:getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e).hide,5e3),!0}}),cancelEvent(a)},publish:function(e,i,t,o){o&&hasClass(o,"loading")||Videoview.showEditBox(i,e,null,!0)},stopStreaming:function(e,i){showFastBox(getLang("video_are_you_sure_stop_streaming_title"),getLang("video_are_you_sure_stop_streaming"),getLang("box_yes"),function(){curBox().hide(),ajax.post("al_video.php?act=live_stop_streaming",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,hash:i},{showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e),onDone:function(){Videoview.reload()},onFail:function(e){return showFastBox(getLang("global_error"),e||getLang("global_error_occured")),!0}})},getLang("box_no"))},broadcastLiveAds:function(e,i,t){mvcur.mvData.launchedLiveAds=1,ajax.post("al_video.php?act=broadcast_live_ads",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,hash:i,stop:t},{showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e),onDone:function(e,i){t?Videoview.removeLiveAdsTimer():Videoview.runLiveAdsTimer(e,i)},onFail:function(e){return showFastBox(getLang("global_error"),e||getLang("global_error_occured")),!0}})},runLiveAdsTimer:function(e,i){mvcur.mvData.liveAdsTimerEl=se(e),ge("mv_main").appendChild(mvcur.mvData.liveAdsTimerEl),disableButton("mv_broadcast_live_ads_button",!0);var t=mvcur.videoRaw,o=vkNow();!function a(){if(t==mvcur.videoRaw&&mvcur.mvShown&&mvcur.mvData.liveAdsTimerEl){var e=intval(i-(vkNow()-o)/1e3);if(0>e)return Videoview.removeLiveAdsTimer();val(domByClass(mvcur.mvData.liveAdsTimerEl,"mv_live_ads_timer_countdown"),formatTime(e)),setTimeout(a,1e3)}}()},removeLiveAdsTimer:function(){re(mvcur.mvData.liveAdsTimerEl),delete mvcur.mvData.liveAdsTimerEl,delete mvcur.mvData.launchedLiveAds,disableButton("mv_broadcast_live_ads_button",!1)},deleteVideo:function(e,i,t,o,a,n,r){n&&hasClass(n,"loading")||ajax.post("al_video.php?act=delete_video",{vid:e,oid:i,hash:t,from:a,sure:o?1:0},{onDone:function(o,d,s,l,v){if(Videoview.recache(i+"_"+e),"sure"==o){Videoview.hidePlayer();var c=showFastBox({title:d,bodyStyle:"padding: 20px; line-height: 160%;"},s);c.setOptions({onHide:function(){Videoview.showPlayer()}}),c.removeButtons(),c.addButton(v,c.hide,"no"),c.addButton(l,function(){c.showProgress(),Videoview.deleteVideo(e,i,t,!0,a,n,c.hide)},"yes")}else if("result"==o&&(r&&r(s),"videoviewer"==a&&(ge("mv_info")&&(hide("mv_info"),val("mv_warning",s),show("mv_warning"),hide("mv_publish")),s=d),window.Video&&Video.isInVideosList()))return Video.updateVideo(cur.oid,[i,e],[],!0),
!0},showProgress:n?addClass.pbind(n,"loading"):!1,hideProgress:n?removeClass.pbind(n,"loading"):!1})},deleteVideoOnClaim:function(e,i,t,o,a,n){Videoview.deleteVideo(e,i,t,o,a,n,function(e){"videoviewer"==a&&(hide("mv_info"),cur.claimedVideoText=val("video_player"),val("video_player",e))})},recache:function(e){!e&&window.mvcur&&mvcur.mvData.videoRaw&&(e=mvcur.mvData.videoRaw);var i=window.ajaxCache;for(var t in i)t.match(/^\/al_video\.php\#act=show/)&&t.match(new RegExp("&video="+e+"([^0-9]|$)",""))&&delete i[t]},getVideoCode:function(e,i){Videoview.sendVideo(!0)},reportBox:function(e,i){Videoview.hidePlayer(),showBox("reports.php?act=a_report_video_box",{oid:e,vid:i},{onHideAttempt:function(){Videoview.showPlayer()},stat:["ui_controls.js","ui_controls.css"]})},setAdult:function(e,i,t,o,a){ajax.post("al_video.php?act=set_adult_video",{vid:i,oid:e,hash:t,value:o},{onDone:function(e,i){val(a,i),lockLink(a)}})},encodingProcess:function(e,i){showBox("al_video.php?act=encoding_process_box",{oid:e,vid:i},{params:{width:600}})},updateEncodingProcess:function(e,i){ajax.post("al_video.php?act=encoding_process_action",{oid:e,vid:i},{onDone:function(t){var o=ge("encoding_process_data");o&&t&&(Videoview.proceedEncodingData(JSON.parse(t),o),setTimeout(function(){Videoview.updateEncodingProcess(e,i)},1e3))}})},proceedEncodingData:function(e,i){var t="";for(var o in e)if(e.hasOwnProperty(o)){var a=e[o];if("object"===("undefined"==typeof a?"undefined":_typeof(a))){if(0===a.length)continue;t+="<tr><td><b>"+o+"</b></td></tr>";for(var n in a)a.hasOwnProperty(n)&&(t+="<tr><td>"+n+"</td><td>"+a[n]+"</td></tr>")}else t+="<tr><td><b>"+o+"</b></td><td>"+a+"</td></tr>"}val(i,'<table width="100%">'+t+"</table>")},replaceLegal:function(e,i,t){showBox("al_video.php?act=replace_legal_box",{oid:e,vid:i,hash:t},{params:{width:600}})},restoreOriginal:function(e,i,t,o){var a="Confirm",n="restore original video?",r=function(){ajax.post("al_video.php?act=restore_original",{vid:i,oid:e,hash:t},{onDone:function(e,i){nav.reload()}})};showFastBox(a,n,getLang("box_yes"),r,getLang("box_no"))},spamVideo:function(e,i,t,o,a,n,r){o&&addClass(o,"loading"),ajax.post("al_video.php?act=spam_video",{vid:i,oid:e,hash:t,sure:n?1:0,from:a},{onDone:function(n,d,s,l,v){if(o&&removeClass(o,"loading"),Videoview.recache(e+"_"+i),"sure"==n){Videoview.hidePlayer();var c=showFastBox({title:d,bodyStyle:"padding: 20px; line-height: 160%;"},s);c.setOptions({onHide:function(){Videoview.showPlayer()}}),c.removeButtons(),c.addButton(v,c.hide,"no"),c.addButton(l,function(){c.showProgress(),Videoview.spamVideo(e,i,t,o,a,!0,c.hide)},"yes")}else if("result"==n){if(r&&r(),window.Video)if("videoviewer"==a)Video.removeFromLists(e+"_"+i);else if("list"==a)return val("video_row"+e+"_"+i,'<div class="video_row">'+s+"</div>"),Video.removeFromLists(e+"_"+i,!0),!0}else val(domPN(o),n)}})},licensed:function(e,i){var t=ge("mv_licensed_info");val(t,""),show(t),showProgress(t),ajax.post("al_video.php?act=change_licensed",{video:mvcur.mvData.videoRaw,hash:i},{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){showProgress(e),disableEl(e)}),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){enableEl(e),hideProgress(e)}),onDone:function(i,o){val(e,i),t&&(val(t,o),toggle(t,!!o))}})},claimed:function(e,i,t,o){i=domData(o,"action")||i,ajax.post("al_claims.php?act=a_"+i,{type:"video",id:mvcur.mvData.vid,owner_id:mvcur.mvData.oid,claim_id:e,extra:t},{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){showProgress(o),disableEl(o)}),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){enableEl(o),hideProgress(o)}),onDone:function(e){val(o,e),domData(o,"action","claim"==i?"unclaim":"claim")}})},setStyle:function(e,i,t){i=ge(i),mvcur.restoreStyles||(mvcur.restoreStyles={});for(var o in t)mvcur.restoreStyles[e]||(mvcur.restoreStyles[e]={}),mvcur.restoreStyles[e][o]=i.style[o],i.style[o]=t[o]},restoreStyle:function(e,i){i=ge(i),setStyle(i,mvcur.restoreStyles[e])},showVideo:function showVideo(videoRaw,title,html,js,desc,opt){if(mvcur.mvShown&&videoRaw==mvcur.videoRaw){if(!vk.id&&!html&&!mvcur.options.expandPlayer)return void setTimeout(function(){Videoview.hide(!1,!0),showDoneBox(title)},500);if(title&&!html&&!mvcur.options.expandPlayer)return val("mv_player_box",'<div class="mv_video_unavailable_message_wrap"><div class="mv_video_unavailable_message">'+title+"</div></div>"),show("mv_player_box"),hide("mv_progress_box"),void hide("mv_info");if(opt=opt||{},addLangKeys(opt.lang,!0),cur.share_timehash=cur.share_timehash||opt.share_timehash,mvcur.post=opt.post,mvcur.maxReplyLength=opt.maxReplyLength,mvcur.maxChatReplyLength=opt.maxChatReplyLength,mvcur.maxDescriptionLength=opt.maxDescriptionLength,mvcur.mvData=opt.mvData,mvcur.videoRaw=opt.mvData.videoRaw,mvcur.adminLevel=opt.mvData.adminLevel,mvcur.commentsTpl=opt.commentsTpl,mvcur.mvMediaTypes=opt.media,mvcur.mvMediaShare=opt.share,mvcur.mvReplyNames=opt.names||{},mvcur.rmedia_types=opt.rmedia_types,mvcur.chatMode=!!opt.chatMode,mvcur.wallTpl=opt.wallTpl,mvcur.finished=!1,mvcur.preparationBlock=!1,opt.queueParams&&(mvcur.queueKey=opt.queueParams.key,mvcur.qversion=opt.qversion),opt.pl_list){var lists=JSON.parse(opt.pl_list);each(lists,function(e,i){_video_playlist2["default"].addList(i)}),Videoview.initPlaylistBlock(mvcur.videoRaw,mvcur.options.playlistId)}_video_playlist2["default"].toggleStateClasses(),Wall.cancelEdit(!0);var needRemin=!0;if(!mvcur.options.expandPlayer){var videoBoxWrap=domByClass(ge("mv_player_box"),"video_box_wrap"),cantPlayFlash=opt.is_flv&&browser.flash<Videoview.FLASH_MIN_VERSION;opt.is_vk_player&&!opt.cantPlay&&!cantPlayFlash&&mvcur.player&&domClosest("video_box_wrap",mvcur.player.el)===videoBoxWrap?(attr(videoBoxWrap,"id","video_box_wrap"+videoRaw),needRemin=!1):(mvcur.player&&re(mvcur.player.el),val("mv_player_box",html)),hide("mv_progress_box")}if(val("mv_info",desc),opt.moder_buttons&&(val("mv_moder_buttons",opt.moder_buttons),_moder_actions2["default"].pin(!0)),opt.player){var container=domByClass(ge("mv_player_box"),"video_box_wrap");_video_initializer2["default"].initPlayer(container,opt.player.type,opt.player.params)}if(js&&eval("(function(){"+js+"})()"),opt.publishAction){var publishAction=ge("mv_publish");val(publishAction,opt.publishAction),show(publishAction)}else hide("mv_publish");if(opt.livePreparationBlock)_video_playlist2["default"].removeBlock(),mvcur.preparationBlock=se(opt.livePreparationBlock),ge("mv_main").appendChild(mvcur.preparationBlock);else if(mvcur.chatMode){_video_playlist2["default"].removeBlock();var chatBlock=se(opt.chatBlock);ge("mv_main").appendChild(chatBlock),_video_chat2["default"].init(chatBlock,{forceStickerPack:opt.chatForceStickerPack}),_video_chat2["default"].toggleStateClasses(),_video_chat2["default"].updateScroll()}toggleClass("mv_box","_has_preparation",!!mvcur.preparationBlock&&!mvcur.minimized);var replyField=ge("reply_field"+mvcur.post);if(replyField&&placeholderInit(replyField,{editable:1}),mvcur.minimized&&needRemin&&Videoview.minimizePlayer(),mvcur.statusVideo){var statusCont=ge("like_count"+mvcur.mvData.videoRaw);if(statusCont){var tt=statusCont.parentNode.tt;tt&&tt.container&&re(tt.container),statusCont.parentNode.tt&&delete statusCont.parentNode.tt}}if(show("mv_player_box"),window.updateWndVScroll&&window.updateWndVScroll(),(mvcur.options||{}).scroll&&(mvLayerWrap.scrollTop=mvcur.options.scroll,mvcur.options.scroll=0),toggle("mv_info",!mvcur.options.hideInfo&&!mvcur.mvData.noControls&&!mvcur.minimized),removeClass("mv_info","mv_info_disabled"),!mvcur.mvData.noControls){var titleWidth=mvcur.minimized?mvcur.minSize.wrap.w:!1;Videoview.setTitle(titleWidth),Videoview.initAddButton();var items=[],sublists={};mvcur.mvData.publishToGroups&&items.push(["_onAddToCommunity",getLang("video_add_to_group")]),mvcur.mvData.canExport&&items.push(["_onExport",getLang("video_export_action")]),mvcur.mvData.stats&&items.push(["_onViewStats",getLang("video_statistics")]),mvcur.mvData.canF&&items.push(["_onF",getLang("reports_atfr")]),mvcur.mvData.reportReasons&&(items.push(["_onReport",getLang("video_complain")]),sublists._onReport={items:mvcur.mvData.reportReasons,onSelect:function(e){return Videoview.reportFromDD(mvcur.mvData.reportHash,e),!0}}),mvcur.mvData.editHash&&mvcur.mvData.editFromDropdown&&!mvcur.mvData.hideEdit&&items.push(["_onEdit",getLang("video_edit")]),mvcur.mvData.deleteHash&&!mvcur.mvData.hideEdit&&items.push(["_onDelete",getLang("video_menu_delete")]),items.length?new InlineDropdown("mv_more",{items:items,withArrow:!0,keepTitle:!0,autoShow:!0,autoHide:300,headerLeft:-17,headerTop:-11,sublists:sublists,onSelect:function(e){Videoview[e]()}}):re("mv_more"),toggle(ge("mv_edit_button"),mvcur.mvData.editHash&&!mvcur.mvData.hideEdit&&!mvcur.mvData.editFromDropdown)}mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight(),Videoview.updateSize(),opt.queueParams&&stManager.add("notifier.js",function(){Videoview.queueCheckUpdates(opt.queueParams)}),mvcur.mvData.uploaded||Videoview.recache(),mvcur.mvData.is_live&&setTimeout(Videoview.checkOtherLives.pbind(videoRaw),6e4)}},adaptRecomsHeight:function(){var e=geByClass1("mv_info_wide_column","mv_info"),i=geByClass1("mv_info_narrow_column","mv_info");if(e&&i)for(var t=geByClass("mv_recom_item",i),o=t.length-1;getSize(e)[1]<getSize(i)[1]&&o>0;o--)hide(t[o])},queueCheckUpdates:function(e){window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e.key&&(window.Notifier&&Notifier.addKey(e,Videoview.queueReceiveUpdates),setTimeout(Videoview.queueCheckUpdates.pbind(e),25e3))},queueReconnect:function(e){var i=Videoview.getMvData(),t=i.oid,o=i.vid,a=t+"_"+o;e?ajax.post("al_video.php?act=get_queue_params",{oid:t,vid:o,hash:i.hash},{onDone:function(e){e&&Videoview.isLayerShown(a)&&(mvcur.queueKey=e.key,Videoview.queueCheckUpdates(e))},onFail:function(){return!0}}):(mvcur.queueReconnectDelay=mvcur.queueReconnectDelay?2*mvcur.queueReconnectDelay:500,setTimeout(function(){Videoview.isLayerShown(a)&&Videoview.queueReconnect(!0)},mvcur.queueReconnectDelay))},queueReceiveUpdates:function(e,i){function t(e,i){return e+"video_"+i+"mv"}if(window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e&&i){if(i.failed)return debugLog("video queue failed",i),mvcur.queueKey=null,void Videoview.queueReconnect();delete mvcur.queueReconnectDelay,mvcur.queueBatchId=(mvcur.queueBatchId||0)+1,each(i.events,function(){var e=this.split("<!>"),i=e[0],o=e[1];if(i==mvcur.qversion)switch(o){case"new_reply":mvcur.chatMode||(Videoview.appendNewComment.apply(Videoview,e.slice(2)),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos());break;case"new_reply_chat":var a=+e[10],n=!!e[11];mvcur.chatMode&&_video_chat2["default"].receiveMessage.apply(_video_chat2["default"],e.slice(2)),n&&!a&&mvcur.player&&mvcur.player.pushDonation("comment",{senderId:e[4],senderName:e[5],senderPhoto:e[6],senderHref:e[7],senderSex:e[8],commentText:e[9]});break;case"edit_reply":var r=e[2],d=e[3],s=e[4],l=ge("wpt"+t(r,d));l&&!attr(l,"data-action")&&(val(l,psr(s)),Videoview.updateReplyFormPos());break;case"del_reply":var v=e[2],c=e[3];if(mvcur.chatMode)_video_chat2["default"].receiveDelete(v,c);else{var u=ge("post"+t(v,c));u?attr(u,"data-action")||(mvcur.mvData.commcount--,mvcur.mvData.commshown--,re(u)):mvcur.mvData.commcount--,Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()}break;case"like_reply":var m=e[2],_=e[3],p=+e[4],h=+e[5],f=e[6],w=ge("wpe_bottom"+t(m,_));if(w){var g=domByClass(w,"_like_wrap"),y=domByClass(g,"_count");val(y,p>0?p:""),toggleClass(g,"no_likes",!p),h==vk.id&&toggleClass(g,"my_like",!f)}break;case"like":var V=e[4],b=e[5];mvcur.chatMode&&!b&&_video_chat2["default"].appendSticker("like",V);break;case"sticker":var C=e[3],S=e[4];mvcur.chatMode&&_video_chat2["default"].appendSticker(C,S);break;case"video_view":Videoview.updateLiveViewersCount(e[2]);break;case"gift":mvcur.player&&mvcur.player.pushDonation("gift",{senderId:e[2],senderName:e[3],senderPhoto:e[4],senderHref:e[5],senderSex:e[6],giftId:e[7]});break;case"end_live":var k=domByClass("mv_publish","mv_stop_streaming_button");k&&(val(k,getLang("video_live_finished")),disableButton(k,!0));break;case"live_midroll":if(mvcur.player&&!mvcur.mvData.launchedLiveAds){var x=!!e[2];mvcur.player.pushLiveMidroll(x)}break;default:debugLog("unhandled video event",e)}})}},appendNewComment:function(e,i,t,o,a,n,r,d,s,l,v){if(!ge("post"+e+"video_"+i+"mv")){var c="";mvcur.adminLevel>0||e==vk.id||t==vk.id?c+=mvcur.commentsTpl.del_reply:e!=t&&(c+=mvcur.commentsTpl.spam_reply),(mvcur.adminLevel>1&&e==t||o==vk.id)&&(c+=mvcur.commentsTpl.edit_reply),c=rs(mvcur.commentsTpl.actions,{actions:c});var u=langDate(1e3*d,getLang("global_short_date_time","raw"),0,[]),m=psr(rs(mvcur.commentsTpl.reply,{actions:c,post_oid:e,reply_id:e+"video_"+i+"mv",reply_msg_id:i,from_id:t,name:o,photo:a,href:n,message:r,date:u,to_link:s}));mvcur.mvReplyNames[t]=[l,v],ge("mv_comments").insertAdjacentHTML("beforeend",m),mvcur.mvData.commcount++,mvcur.mvData.commshown++}},updateLiveViewersCount:function(e,i){if(e=intval(e)){var t=domByClass("mv_views","mv_live_spectators_count_text"),o=getLang("video_live_N_watching",e,!0);val(t,o)}if(i){var a=domByClass("mv_views","mv_live_spectators_friends"),n=i.map(function(e){return getTemplate("video_live_spectators_friend",e)}).reverse().join("");val(a,n)}},showLiveSpectatorsBox:function(){var e=Videoview.getMvData();showBox("al_video.php?act=live_spectators_box",{owner_id:e.oid,video_id:e.vid,hash:e.hash},{params:{grey:!0,hideButtons:!0,width:638,bodyStyle:"padding: 0; border: 0;",onShow:function(){addEvent(boxLayerWrap,"scroll",Videoview.onLiveSpectatorsScroll),setTimeout(Videoview.onLiveSpectatorsScroll,0)},onHide:function(){removeEvent(boxLayerWrap,"scroll",Videoview.onLiveSpectatorsScroll)}},onFail:function(e){return curBox().hide(),showFastBox(getLang("global_error_occured"),e),!0}})},onLiveSpectatorsScroll:function(){var e=lastWindowHeight,i=ge("video_spectators_more_link");isVisible(i)&&e>getXY(i,!0)[1]&&i.click()},loadMoreLiveSpectators:function(e){if(!isButtonLocked(e)){var i=mvcur.liveSpectatorsPerPage,t=mvcur.liveSpectatorsShown,o=mvcur.liveSpectatorsList.slice(t,t+i);if(o.length){var a=Videoview.getMvData();ajax.post("al_video.php?act=live_spectators_box",{owner_id:a.oid,video_id:a.vid,more:o.join(","),hash:a.hash},{onDone:function(o,a){var n=ge("video_spectators_rows");if(n.insertAdjacentHTML("beforeend",o),mvcur.liveSpectatorsShown=t+i,mvcur.liveSpectatorsShown>=mvcur.liveSpectatorsList.length&&hide(e),mvcur.liveSpectatorsShown>=mvcur.liveSpectatorsLimit){hide(e);var r=ge("video_spectators_bottom");n.appendChild(r),show(r)}},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})}}},checkOtherLives:function(e){mvcur.mvShown&&!mvcur.minimized&&mvcur.videoRaw==e&&(ajax.post("al_video.php?act=live_other_videos",{video:e},{onDone:function(i){Videoview.updateOtherLives(e,i)},onFail:function(){return!0}}),setTimeout(Videoview.checkOtherLives.pbind(e),6e4))},updateOtherLives:function(e,i){if(mvcur.mvShown&&mvcur.videoRaw==e){var t=domByClass(window.mvLayer,"mv_info_narrow_column");val(t,i),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight()}},finishLivePreparation:function(e){var i=Videoview.getMvData();ajax.post("al_video.php?act=live_finish_preparation",{oid:i.oid,vid:i.vid,notify_followers:isChecked("mv_live_preparation_notify_followers"),hash:e},{onDone:Videoview.reload})},reload:function(){var e=Videoview.getMvData();Videoview.hide(!0,!0),Videoview.recache(e.videoRaw),showVideo(e.videoRaw,"",{autoplay:1})},onVideoShared:function(e,i,t){"publish"!=e||Videoview._isCurrentVideoPublished()||(Videoview.hide(!0,!0),setTimeout(function(){0==i.indexOf("video")&&(i=i.substr("video".length)),Videoview.recache(i),showVideo(i,t)},100))},_onAddToCommunity:function(){showBox("al_video.php?act=add_to_club_pl_box",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid})},_onEdit:function(){var e=Videoview.getMvData(),i=e.oid,t=e.vid;Videoview.showEditBox(t,i)},_onDelete:function(){var e=Videoview.getMvData(),i=e.oid,t=e.vid,o=e.deleteHash,a=!1,n="videoviewer";Videoview.deleteVideo(t,i,o,a,n)},_onExport:function(){Videoview.sendVideo(!0)},_onF:function(){sfof(mvcur.mvData.oid,mvcur.mvData.vid,2)},_onViewStats:function(){showBox("al_stats.php",{act:"video_stat",oid:mvcur.mvData.stats.stat_oid,vid:mvcur.mvData.stats.stat_vid},{params:{width:795,bodyStyle:"padding: 0"}})},addToClubPlaylistBoxInit:function(e,i,t){function o(e,i){return hide("mv_add_to_club_albums"),val("mv_add_to_club_albums_list",""),-1==e?void val("mv_add_to_club_gid",""):(show("mv_add_to_club_albums_progress"),void ajax.post("al_video.php?act=a_get_club_playlists",{gid:i,oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{onDone:function(e){var t="";each(e,function(e,i){t+='<div class="mv_add_to_club_albums_list_item checkbox '+(+i.added?"on":"")+'" data-id="'+i.id+'" onclick="checkbox(this)">'+i.title+"</div>"}),val("mv_add_to_club_albums_list",t),val("mv_add_to_club_gid",i),hide("mv_add_to_club_albums_progress"),show("mv_add_to_club_albums")}}))}WideDropdown.deinit("add_to_pl_club_dd"),mvcur.addToClubPl=WideDropdown.init("add_to_pl_club_dd",{defaultItems:i,noResult:"no result",introText:"choose",onChange:o}),setTimeout(elfocus.pbind("add_to_pl_club_dd_input"),0),e.removeButtons(),e.addButton(getLang("Save"),function(e){var i=[];each(geByClass("mv_add_to_club_albums_list_item"),function(e,t){isChecked(t)&&i.push(attr(t,"data-id"))}),ajax.post("al_video.php?act=a_add_to_playlist",{hash:t,gid:val("mv_add_to_club_gid"),oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,playlists:i.length?i:"0"},{showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e),onDone:function(){curBox().hide(),showDoneBox(getLang("video_changes_saved"))}})},null,!0)},setTitle:function(e){var i=mvcur.mvData.title||"";e=e||590,val("mv_min_title",Videoview._isCurrentVideoPublished()?stripHTML(i):""),setStyle("mv_min_title",{maxWidth:Math.max(0,e-70)});var t=ge("mv_title");t&&(val(t,i),setStyle(t,{display:"block"}),t.scrollHeight>t.offsetHeight&&attr(t,"title",replaceEntities(stripHTML(i))),setStyle(t,{display:""}))},expandDescr:function(e){val("mv_descr_field",val("mv_desc_full_text")),Videoview.cleanExpandDescrEls()},cleanExpandDescrEls:function(){re(ge("mv_desc_full_text")),re(ge("mv_descr_expand_toggle"))},setDesc:function(){ge("mv_descr_field")&&val(ge("mv_descr_field"),mvcur.mvData.desc||"")},getContSize:function(){return mvcur.contSize||(mvcur.contSize=getSize("mv_box")),mvcur.contSize},getContPlace:function(e,i){var t=0,o=Videoview.getContSize(),a=e.clientX-mvcur.minSize.wrap.l,n=e.clientY-mvcur.minSize.wrap.t;return 6>n&&(t+=1),a>o[0]-20&&(t+=2),n>o[1]-10&&(t+=4),10>a&&(t+=8),1==t&&a>o[0]-55&&(t=0),!t&&25>n&&a<o[0]-55&&(t+=16),t},changeCursor:function(e){if(!Videoview.isFS){var i=Videoview.getContPlace(e),t="default";if(i&&mvcur.minimized){var o="";1&i&&(o+="n"),4&i&&(o+="s"),2&i&&(o+="e"),8&i&&(o+="w"),t=o+"-resize",16&i&&(t="move")}setStyle("mv_box",{cursor:t})}},getMinSize:function(){extend(mvcur.minSize,{wrap:{t:intval(mvLayerWrap.style.top),l:intval(mvLayerWrap.style.left),w:intval(mvLayerWrap.style.width),h:intval(mvLayerWrap.style.height)},player:{w:intval(mvcur.mvPlayer&&mvcur.mvPlayer.style.width),h:intval(mvcur.mvPlayer&&mvcur.mvPlayer.style.height)}})},startDrag:function(e){if(!(Videoview.isFS||e.button&&1!==e.button)){var i=Videoview.getContPlace(e,!0);if(i){var t=vkNow();Videoview.getMinSize(),extend(mvcur.minSize,{x:e.clientX,y:e.clientY}),mvcur.resizeDiff=0;var o=!i||16&i?Videoview.onMinMove:Videoview.onMinResize;mvcur.resizeMask=i;var a=function n(e){removeEvent(document,"mouseup",n),removeEvent(document,"mousemove",o),removeEvent(document,"drag",o);var a=vkNow();return Videoview.getMinSize(),mvcur.resizeDiff<8&&400>a-t&&(16&i||1==i)&&Videoview.unminimize(),removeClass(mvLayerWrap,"mv_resizing"),removeClass("mv_player_box","no_events"),addEvent("mv_box","mousemove",Videoview.changeCursor),ls.set("mv_minSize",mvcur.minSize),!1};return addClass(mvLayerWrap,"mv_resizing"),addClass("mv_player_box","no_events"),addEvent(document,"mouseup",a),addEvent(document,"mousemove",o),addEvent(document,"drag",o),removeEvent("mv_box","mousemove",Videoview.changeCursor),cancelEvent(e)}}},onMinMove:function(e){var i=0,t=0;return e&&(t=e.clientY-mvcur.minSize.y,i=e.clientX-mvcur.minSize.x),mvcur.minSize.wrap.t+t>mvcur.minSize.ch-mvcur.minSize.wrap.h-15&&(t=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+i>mvcur.minSize.cw-mvcur.minSize.wrap.w-15&&(i=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l),mvcur.minSize.wrap.t+t<15&&(t=-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+i<15&&(i=-mvcur.minSize.wrap.l),setStyle(mvLayerWrap,{top:mvcur.minSize.wrap.t+t+"px",left:mvcur.minSize.wrap.l+i+"px"}),mvcur.resizeDiff=Math.max(Math.abs(i),Math.max(Math.abs(t),mvcur.resizeDiff)),e?cancelEvent(e):!1},onMinResize:function(e){var i=mvcur.resizeMask,t=0,o=0,a=1&i||4&i?e.clientY-mvcur.minSize.y:0,n=2&i||8&i?e.clientX-mvcur.minSize.x:0;4&i&&mvcur.minSize.wrap.t+a>mvcur.minSize.ch-mvcur.minSize.wrap.h&&(a=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),1&i&&mvcur.minSize.wrap.t+a<0&&(a=-mvcur.minSize.wrap.t),2&i&&mvcur.minSize.wrap.l+n>mvcur.minSize.cw-mvcur.minSize.wrap.w-14&&(n=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l-14),8&i&&mvcur.minSize.wrap.l+n<0&&(n=-mvcur.minSize.wrap.l),8&i&&(t=n,n=-n),1&i&&(o=a,a=-a),mvcur.minSize.wrap.w+n<307&&(n=307-mvcur.minSize.wrap.w,8&i&&(t=-n)),mvcur.minSize.wrap.h+a<200&&(a=200-mvcur.minSize.wrap.h,1&i&&(o=-a)),setStyle(mvLayerWrap,{left:positive(mvcur.minSize.wrap.l+t)+"px",top:positive(mvcur.minSize.wrap.t+o)+"px",width:mvcur.minSize.wrap.w+n+"px",height:mvcur.minSize.wrap.h+a+"px"}),setStyle(mvcur.mvPlayer,{width:mvcur.minSize.player.w+n+"px",height:mvcur.minSize.player.h+a+"px"});var r=Math.abs(n)+Math.abs(a);return mvcur.resizeDiff=Math.max(r,mvcur.resizeDiff),mvcur.contSize=!1,Videoview.setTitle(mvcur.minSize.wrap.w+n),Videoview.playerOnResize(),Videoview.updateExternalVideoFinishBlock(),!1},minimize:function(e){if(e&&cancelEvent(e),mvcur.minimized)return!1;show("mv_min_header"),hide("mv_info"),hide("mv_top_controls"),isVisible("mv_approve")?(mvcur.needShowApprove=!0,hide("mv_approve")):mvcur.needShowApprove=!1,Wall.cancelEdit(!0),addClass(mvLayerWrap,"mv_minimized"),mvcur.minSize||(mvcur.minSize=ls.get("mv_minSize"));var i="mv_dark";removeClass(mvLayerWrap,i),removeClass(window.layerBG,i),layers.fullhide=!1,mvcur.minSize&&Videoview.enabledResize()&&mvcur.minSize.wrap.w||(mvcur.minSize={wrap:{w:307,h:200}});var t=mvcur.minSize.wrap;mvcur.minSize.player={w:t.w-12,h:t.h-34},Videoview.setStyle("mvContainer","mv_container",{marginTop:0,marginBottom:0}),setStyle(window.mvLayer,{width:"auto"}),Videoview.minimizePlayer(),window.tooltips&&tooltips.destroyAll("mv_container"),removeEvent(window,"resize",Videoview.onResize),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),addEvent(window,"resize",Videoview.minResize),Videoview.enabledResize()?(addEvent("mv_box","mousedown",Videoview.startDrag),addEvent("mv_box","mousemove",Videoview.changeCursor),mvcur.minDestroy=function(){removeEvent("mv_box","mousedown",Videoview.startDrag),removeEvent("mv_box","mousemove",Videoview.changeCursor),setStyle("mv_box",{cursor:"default"})}):(addEvent(ge("mv_min_title"),"click",Videoview.unminimize),mvcur.minDestroy=function(){removeEvent("mv_min_title","click",Videoview.unminimize)}),Videoview.setTitle(t.w),Videoview.minResize(),Videoview.setStyle("mvLayerWrap",mvLayerWrap,{width:mvcur.minSize.wrap.w+"px",height:mvcur.minSize.wrap.h+"px"}),mvcur.minimized=!0,layers.wraphide(),setTimeout(Videoview.playerOnResize,10);var o=window.layerQueue.count();return mvcur.noLocChange||(Videoview.backLocation(),mvcur.noHistory=1),window.layerQueue.skipVideo=!0,o&&(debugLog("pop from minimize"),window.layerQueue.pop()),_video_playlist2["default"].toggleStateClasses(),_video_chat2["default"].toggleStateClasses(),mvcur.preparationBlock&&removeClass("mv_box","_has_preparation"),Videoview.updateExternalVideoFinishBlock(),!1},isLayerShown:function(e){return!(!window.mvcur||!mvcur.mvShown||null!=e&&mvcur.videoRaw!=e)},isMinimized:function(){return!!(window.mvcur&&mvcur.mvShown&&mvcur.minimized)},enabledResize:function(){return!browser.mobile},minimizePlayer:function(){if(mvcur.mvPlayer=ge("mv_player_box"),mvcur.mvPlayer){var e={width:mvcur.minSize.player.w+"px",height:mvcur.minSize.player.h+"px"};Videoview.setStyle("mvPlayer",mvcur.mvPlayer,e),Videoview.playerOnResize()}},minResize:function(){mvcur.minSize.ch=window.innerHeight||htmlNode.clientHeight||bodyNode.clientHeight,mvcur.minSize.cw=window.innerWidth||htmlNode.clientWidth||bodyNode.clientWidth;var e=getXY(ge("page_layout"));void 0===mvcur.minSize.wrap.t&&(mvcur.minSize.wrap.t=mvcur.minSize.ch-mvcur.minSize.wrap.h),void 0===mvcur.minSize.wrap.l&&(mvcur.minSize.wrap.l=Math.max(String(e[0]-mvcur.minSize.player.w/2),30)),setStyle(mvLayerWrap,{left:mvcur.minSize.wrap.l+"px",top:mvcur.minSize.wrap.t+"px"}),Videoview.onMinMove(),mvcur.minimized&&Videoview.getMinSize()},unminimize:function(e,i,t){if(mvcur.minimized){var o=window.wkcur,a=window.WkView;o&&"story"==o.type&&window.Stories&&a.hide(!1,!0),t||window.layerQueue.push(),i||(window.layerQueue.hide(),setTimeout(function(){mvcur.noHistory=1,window.layerQueue.noHistory(),layers.wrapshow(mvLayerWrap,.7),layers.fullhide=Videoview.hide},0)),Videoview.hidePlayer(!0),mvcur.minimized=!1,removeClass(mvLayerWrap,"mv_minimized"),Videoview.restoreStyle("mvLayerWrap",mvLayerWrap),toggle("mv_info",!mvcur.options.hideInfo&&!mvcur.mvData.noControls&&!mvcur.minimized),hide("mv_min_header"),show("mv_top_controls");var n="mv_dark";return addClass(mvLayerWrap,n),addClass(window.layerBG,n),mvcur.needShowApprove&&(mvcur.needShowApprove=!1,show("mv_approve")),Videoview.restoreStyle("mvContainer","mv_container"),mvcur.mvPlayer&&Videoview.restoreStyle("mvPlayer",mvcur.mvPlayer),setStyle("mv_player_box",{width:"",height:""}),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight(),Videoview.updateSize(),addEvent(window,"resize",Videoview.onResize),addEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),addEvent(document,"keydown",Videoview.onKeyDown),removeEvent(window,"resize",Videoview.minResize),mvcur.minDestroy&&mvcur.minDestroy(),mvcur.noLocChange||e===!0||Videoview.setLocation(),window.onBodyResize(!0),setStyle(mvLayerWrap,{left:"0px",top:"0px"}),Videoview.showPlayer(!0),Videoview.setTitle(),_video_playlist2["default"].toggleStateClasses(),mvcur.chatMode&&(_video_chat2["default"].toggleStateClasses(),_video_chat2["default"].updateScroll()),mvcur.preparationBlock&&addClass("mv_box","_has_preparation"),Videoview.viewScroll(),Videoview.playerOnResize(),!1}},toggleSideBlock:function(e){return mvcur.chatMode?_video_chat2["default"].toggle():_video_playlist2["default"].toggle(),cancelEvent(e)},sendVideo:function(e){Videoview.hidePlayer();var i=showBox("like.php?act=publish_box",{object:"video"+mvcur.videoRaw,list:mvcur.listId,is_export:e},{stat:["page.js","page.css","wide_dd.js","wide_dd.css","sharebox.js"]});i.setOptions({onHideAttempt:function(){return Videoview.showPlayer(),!0}}),Videoview.playerNextTimerUpdate()},showDD:function(e,i){if(clearTimeout(cur.hideShareTimer),e.blur(),!hasClass(i,"mv_dd_hiding")){if(isVisible(i))return fadeIn(i,0);cur.ddShown&&Videoview.hideDD(0),cur.ddShown=i,setTimeout(addEvent.pbind(document,"click",Videoview.hideDD),1),show(i)}},hideDD:function(e){if(e>0)return void(cur.hideShareTimer=setTimeout(Videoview.hideDD.pbind(0),e));var i=cur.ddShown;i&&(-1==e?hide(i):(addClass(i,"mv_dd_hiding"),fadeOut(i,200,function(){removeClass(i,"mv_dd_hiding")})),removeEvent(document,"click",Videoview.hideDD),cur.ddShown=!1)},reportFromDD:function(e,i){ajax.post("reports.php?act=new_report",{type:"video",reason:i,hash:e,oid:mvcur.mvData.oid,item_id:mvcur.mvData.vid},{onDone:function(e){showDoneBox(e)}})},reportComment:function(e,i,t){stManager.add(["privacy.js","privacy.css"],function(){return Privacy.show(e,i,"report_"+t)})},descTT:function(e){return showTooltip(e,{text:getLang("video_edit_desc"),black:1,shift:[0,7,0],showdt:0})},viewScroll:function(){var e=6,i=getXY("mv_main",!0)[1],t=getSize("mv_player_box")[1],o=i-e;o=0>o?-o:0,toggleClass("mv_top_controls","fixed",o>0),toggleClass("mv_pl_prev","fixed",o>0),toggleClass("mv_pl_next","fixed",o>0),toggleClass("mv_top_pl_toggle","hidden",o>t),mvcur.scrolledAway=o>t/3,Videoview.playerNextTimerUpdate(),Videoview.updateReplyFormPos()},updateReplyFormPos:function(){var e=ge("mv_reply_form"),i=ge("mv_comments_wrap"),t=getSize(e),o=domPN(e),a=window.clientHeight(),n=getXY(mvLayerWrap)[1],r=getXY("mv_box")[1]-n,d=getXY(i)[1]-n,s=getSize(i)[1],l=getSize("mv_box")[1],v=r+l>a&&s>0;v?(addClass(e,"mv_reply_form_fixed"),setStyle(e,{bottom:Math.min(a-d-t[1],0)+"px"}),setStyle(o,{width:t[0]+"px",height:t[1]+"px"})):(removeClass(e,"mv_reply_form_fixed"),setStyle(e,{bottom:null}),setStyle(o,{width:null,height:null}))},editInline:function(e){if(!(e&&"A"==e.target.tagName||!window.mvcur||mvcur.mvEditing)&&ge("mv_description")){var i=mvcur.videoRaw,t=mvcur.mvShown,o=mvcur.mvData,a=!o.desc,n=function(e){if(mvcur.mvShown&&mvcur.videoRaw==i&&mvcur.mvShown==t&&!mvcur.mvEditing){Videoview.cleanExpandDescrEls(),mvcur.mvEditing=i;var o="margin-bottom:"+(browser.chrome||browser.safari?-4:0)+"px",a=ce("div",{id:"mv_edit_text_wrap",innerHTML:'<textarea id="mv_edit_text" style="'+o+'" onkeydown="onCtrlEnter(event, Videoview.saveInline)" onkeyup="checkTextLength(mvcur.maxDescriptionLength, this, ge(\'mv_caption_warn\'));" placeholder="'+getLang("video_edit_desc_intro")+'">'+e+'</textarea><div id="mv_caption_warn"></div>'});ge("mv_description").appendChild(a);var n=ge("mv_edit_text");setStyle(n,{width:ge("mv_description").offsetWidth+"px"}),placeholderInit(n),autosizeSetup(n,{minHeight:18,ignorePadding:!0}),setTimeout(function(){show(a),elfocus(n),addEvent(n,"blur",Videoview.saveInline),hide("mv_descr_field")},1)}};a?n(""):ajax.post("al_video.php?act=edit_desc",{oid:o.oid,vid:o.vid},{onDone:n,progress:"mv_inline_edit_pr"})}},cancelInline:function(){mvcur.mvEditing=!1,removeEvent("mv_edit_text","blur"),show("mv_descr_field"),re("mv_edit_text_wrap")},saveInline:function(){if(mvcur.mvEditing){removeEvent("mv_edit_text","blur");var e=mvcur.mvEditing,i=Videoview.getMvData();ajax.post("al_video.php?act=save_desc",{oid:i.oid,vid:i.vid,hash:i.editHash,desc:val("mv_edit_text")},{onDone:function(t){if(i.desc=t,Videoview.isLayerShown(e)){mvcur.mvEditing=!1;var o=ge("mv_descr_field");val(o,t||'<span class="mv_desc_edit">'+getLang("video_edit_desc")+"</span>"),o.onmouseover=t?Videoview.descTT.pbind(o):function(){},show(o),re("mv_edit_text_wrap")}},progress:"mv_inline_edit_pr"})}},onExternalVideoEnded:function(e){e=e||domPN(ge("video_player"));var i=getSize(e),t=_slicedToArray(i,2),o=t[0],a=t[1],n=(Videoview.getNextVideosData()||[])[0],r=!!window.CanvasRenderingContext2D,d=Videoview.getMvData();if(e&&d&&!ge("mv_external_finish")){Videoview.logViewedPercentage();var s="";if(n&&o>=400&&a>=300)s='\n        <div id="mv_finish_next" class="mv_finish_next" onclick="Videoview.onExternalVideoNext(true)">\n          <div class="mv_finish_next_caption">'+getLang("video_player_next_title")+'</div>\n          <div class="mv_finish_next_thumb" style="background-image: url('+n.thumb+')"></div>\n          <div class="mv_finish_next_timer">\n            <canvas class="mv_finish_next_timer_canvas" width="100" height="100"></canvas>\n            <div class="mv_finish_next_timer_play mv_finish_icon"></div>\n          </div>\n          <div class="mv_finish_next_info">\n            <div class="mv_finish_next_title">'+n.title+'</div>\n            <div class="mv_finish_next_views">'+n.views+'</div>\n          </div>\n          <div class="mv_finish_next_cancel mv_finish_icon" onclick="Videoview.onExternalVideoNextCancel(event)"></div>\n        </div>\n      ';else if(!ge("video_yt"))return;
var l=Videoview.getSuggestionsData(),v="onSuggestionClick";l&&l.length||(l=Videoview.getNextVideosData(),v="onVideoNext");var c="";l&&l.length&&o>=580&&a>=300&&(c='<div id="mv_finish_suggestions" class="mv_finish_suggestions '+(s?"hidden":"")+'">',each(l,function(e,i){c+='\n          <a class="mv_finish_suggestions_item" onclick="videoCallback([\''+v+"', '"+i.vid+'\']); return false;" href="/video'+i.vid+'" title="'+i.title+'">\n            <div class="mv_finish_suggestions_item_thumb" style="background-image: url('+i.thumb+')"></div>\n            <div class="mv_finish_suggestions_item_title">'+i.title+'</div>\n            <div class="mv_finish_suggestions_item_views">'+i.views+"</div>\n          </a>\n        "}),c+="</div>");var u=!1,m=!1;if(!s&&!c){if(d.noControls||d.nolikes)return;o>250&&a>200?u=!0:m=!0}var _=se('\n      <div class="mv_external_finish" id="mv_external_finish" onclick="Videoview.onExternalVideoBgClick(this, event)">\n        <div class="mv_finish_header">\n          <div id="mv_finish_subscribe" class="fl_r mv_finish_subscribe '+(d.subscribed?"mv_finish_subscribed":"")+'">\n            <button id="mv_finish_subscribe_btn" class="mv_finish_subscribe_btn fl_l" onclick="Videoview.onExternalVideoSubscribe()">'+getLang(d.subscribed?"video_view_subscribed_msg":"video_view_subscribe_to_author")+'</button>\n            <a href="'+d.authorHref+'" target="_blank" class="fl_r"><img class="mv_finish_author_img" src="'+d.authorPhoto+'"></a>\n          </div>\n          <div id="mv_finish_title" class="mv_finish_title" style="'+(Videoview.isMinimized()?"display:none":"")+'">'+d.title+'</div>\n        </div>\n        <div id="mv_finish_actions" class="mv_finish_actions '+(u?"mv_finish_actions_extended":"")+" "+(d.can_add?"":"mv_finish_actions_cant_add")+" "+(m?"mv_finish_actions_no_content":"")+'">\n          <div class="mv_finish_like '+(d.liked?"selected":"")+'" onclick="Videoview.onExternalVideoLike()">\n            <div class="mv_finish_like_icon mv_finish_icon"></div>\n            <div class="mv_finish_liked_icon mv_finish_icon"></div>\n            <div class="mv_finish_like_text">'+getLang("video_i_like")+'</div>\n          </div>\n          <div class="mv_finish_share" onclick="Videoview.onExternalVideoShare()">\n            <div class="mv_finish_share_icon mv_finish_icon"></div>\n            <div class="mv_finish_share_text">'+getLang("video_share_with_friends")+'</div>\n          </div>\n          <div class="mv_finish_add '+(d.added?"selected":"")+'" onclick="Videoview.onExternalVideoAdd()">\n            <div class="mv_finish_add_icon mv_finish_icon"></div>\n            <div class="mv_finish_added_icon mv_finish_icon"></div>\n          </div>\n        </div>\n        '+s+"\n        "+c+"\n      </div>\n    ");d.canSubscribe||re(geByClass1("mv_finish_subscribe",_)),(d.noControls||d.nolikes)&&re(geByClass1("mv_finish_actions",_)),e.appendChild(_),r&&n&&s&&(window.focus(),mvcur.nextTimer={ctx:geByClass1("mv_finish_next_timer_canvas",_).getContext("2d"),nextTimerReset:function(){clearTimeout(mvcur.nextTimer.timeout),mvcur.nextTimer.ctx.clearRect(0,0,100,100),mvcur.nextTimer.started=null},nextTimerStart:function(){mvcur.nextTimer.started||(mvcur.nextTimer.started=(new Date).getTime(),Videoview.onExternalVideoTimer())}},mvcur.nextTimer.ctx.lineWidth=6,mvcur.nextTimer.ctx.lineCap="round",mvcur.nextTimer.ctx.strokeStyle="#fff",mvcur.nextTimerStopped||mvcur.nextTimer.nextTimerStart())}},onExternalVideoTimer:function(){if(window.mvcur&&mvcur.nextTimer&&mvcur.nextTimer.ctx&&mvcur.nextTimer.started){var e=Math.min(1,Math.max(0,((new Date).getTime()-mvcur.nextTimer.started)/1e4)),i=mvcur.nextTimer.ctx;i.clearRect(0,0,100,100),i.beginPath(),i.arc(50,50,47,-Math.PI/2,-Math.PI/2+2*Math.PI*e),i.stroke(),1>e?mvcur.nextTimer.timeout=setTimeout(Videoview.onExternalVideoTimer,20):Videoview.onExternalVideoNext()}},onExternalVideoNext:function(e){Videoview.removeExternalVideoFinishBlock(),mvcur.nextTimer=null,_video_playlist2["default"].nextVideo(),Videoview.sendPlayerStats(e?6:5,4)},onExternalVideoNextCancel:function(e){e&&e.stopPropagation(),clearTimeout(mvcur.nextTimer.timeout),mvcur.nextTimer=null,ge("video_yt")?(re("mv_finish_next"),removeClass("mv_finish_suggestions","hidden")):re("mv_external_finish")},onExternalVideoBgClick:function(e,i){i.target===e&&Videoview.removeExternalVideoFinishBlock()},onExternalVideoLike:function(){videoCallback(["onLike",4]),Videoview.playerOnLiked()},onExternalVideoShare:function(){if(Videoview.isFS){var e=Videoview.getPlayerObject();e&&e.toggleFullscreen&&e.toggleFullscreen()}videoCallback(["onShare",4])},onExternalVideoAdd:function(){var e=Videoview.getMvData();if(e){e.added?videoCallback(["onRemove"]):videoCallback(["onAdd",e.videoRaw,e.add_hash,4]);var i=Videoview.getPlayerObject();i.onAdded&&i.onAdded()}},onExternalVideoSubscribe:function(){var e=Videoview.getMvData();if(e){var i=!e.subscribed;Videoview.subscribeToAuthor(i,"external_player",!1),Videoview.sendPlayerStats(i?9:10,4)}},updateExternalVideoFinishBlock:function(){var e=ge("mv_external_finish");if(e){var i=getSize(e),t=_slicedToArray(i,2),o=t[0],a=t[1];(isVisible("mv_finish_next")&&(400>o||300>a)||isVisible("mv_finish_suggestions")&&(580>o||300>a)||hasClass("mv_finish_actions","mv_finish_actions_extended")&&(250>o||200>a))&&(mvcur.nextTimer&&Videoview.onExternalVideoNextCancel(),re("mv_finish_next"),re("mv_finish_suggestions"),removeClass("mv_finish_actions","mv_finish_actions_extended"),addClass("mv_finish_actions","mv_finish_actions_no_content")),toggle("mv_finish_title",!Videoview.isMinimized()),toggleClass("mv_finish_subscribe","mv_finish_subscribe_min",500>o)}},removeExternalVideoFinishBlock:function(){window.mvcur&&mvcur.nextTimer&&Videoview.onExternalVideoNextCancel(),re("mv_external_finish")},logViewedPercentage:function(){if(window.mvcur&&mvcur.mvData&&mvcur.mvData.videoRaw&&mvcur.mvData.duration){var e=mvcur.mvData,i=e.videoRaw,t=e.duration,o=vkNow(),a=mvcur.viewStartedTimestamp;if(!a)return!1;delete mvcur.viewStartedTimestamp;var n=Math.min(Math.round((o-a)/1e3),t);ajax.post("al_video.php?act=a_viewed_percentage",{video_raw:i,viewed_time:n,duration:t})}}}},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={resize:function(e,i){},debugLog:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(){for(var e=arguments.length,i=Array(e),t=0;e>t;t++)i[t]=arguments[t];i.unshift("video player:"),debugLog.apply(null,i)}),fullscreen:function(e){Videoview.isFS=e,Videoview.updateExternalVideoFinishBlock()},incViewCounter:function(e,i,t,o,a,n,r){var d={oid:e,vid:i,hash:t,curr_res:o,max_res:a,player:n||"flash",type:r,module:Videoview.getVideoModule(e+"_"+i)};if(cur.videoSearchStats){var s=parseInt(cur.videoSearchPos);isNaN(s)||(d.search_pos=s,cur.videoSearchStats.positions[s]=extend({viewStarted:0},cur.videoSearchStats.positions[s]),cur.videoSearchStats.positions[s].viewStarted++),cur.videoSearchStats.totalViews++}ajax.post("al_video.php?act=inc_view_counter",d)},rotateVideo:function(e,i,t,o){ajax.post("al_video.php?act=rotate_video",{oid:e,vid:i,angle:t,hash:o})},scoreCardCounter:function(){},onVideoNext:function(e,i,t){setTimeout(function(){var o=0;i||e?i&&t?o=5:i&&!t?o=6:e&&(o=7):o=4,Videoview.sendPlayerStats(o,0),VideoPlaylist.getBlock()?e&&!i?VideoPlaylist.showVideo(e):VideoPlaylist.nextVideo():showVideo(e,"",{autoplay:1,module:Videoview.getVideoModule(e)})},0)},fetchSuggestions:function(e,i){if(e){var t=Videoview.getMvData(),o=t.videoRaw;ajax.post("al_video.php?act=fetch_player_suggestions",{oid:t.oid,vid:t.vid,videos:e,prepend_current:i?1:0},{onDone:function(e){var i=Videoview.getMvData();if(i&&i.videoRaw==o){i.playerSuggestions=e;var t=cur.videoInlinePlayer||window.mvcur&&mvcur.player||cur.player;t&&t.setSuggestions(e)}}})}},setSuggestions:function(e){Videoview.playerCallback.fetchSuggestions(e)},onSuggestionsShown:function(e,i,t){var o=t?16:e?14:12;if(Videoview.sendPlayerStats(o,0),e){var a=Videoview.getMvData(),n="";each(a.playerSuggestions,function(e,t){t.vid!=i&&(n+="&vid="+t.vid)}),vkImage().src="//go.imgsmail.ru/vk?pxn=vs&qid="+e+n}},onSuggestionClick:function(e,i,t,o,a){var n=a?15:i?13:11;Videoview.sendPlayerStats(n,0),showVideo(e,"",{autoplay:1,module:Videoview.getVideoModule(e),addParams:{suggestions_qid:i}}),i&&(vkImage().src="//go.imgsmail.ru/vk?pxn=vic&qid="+i+"&vid="+e+"&p="+t+"&t="+o)},onSuggestionQuarterWatched:function(e,i,t){vkImage().src="//go.imgsmail.ru/vk?pxn=vt25&qid="+e+"&vid="+i+"&t="+t},onSuggestionsReplayClicked:function(){Videoview.sendPlayerStats(17,0)},onOpenInPopup:function(e,i,t){Videoview.sendPlayerStats(8,0);var o=cur.videoInlinePlayer&&cur.videoInlinePlayer.canExpand()?cur.videoInlinePlayer:null,a=window._videoLastInlined?domData(domClosest("post",window._videoLastInlined[1]),"post-id"):null,n=window._videoLastInlined?domData(window._videoLastInlined[1],"playlist"):null;showVideo(e,i,{expandPlayer:o,playlistId:n,autoplay:1,addParams:{t:t,post_id:a}})},onVideoAdEvent:function(e,i,t,o,a,n,r){if(t){cur._vadStatQueue=cur._vadStatQueue||{},cur._vadStatQueue[e+"_"+i]=cur._vadStatQueue[e+"_"+i]||{type:"",events:[]};var d=cur._vadStatQueue[e+"_"+i];d.type=a,d.events.push(o),d.pl_type=r,clearTimeout(cur._vadStatTimer),cur._vadStatTimer=setTimeout(Videoview.sendVideoAdStat.bind(Videoview,e,i,t),1e3)}},onVideoAdShown:function(e,i,t,o){ajax.post("al_video.php?act=ad_event",{oid:e,vid:i,type:t,event:o})},onVideoResolutionChanged:function(e,i,t,o){var a=Videoview.getMvData();a&&(a.resolution=o)},onInitialized:function(){Videoview.isLayerShown()&&(VideoPlaylist.toggle(!VideoPlaylist.isCollapsed()),mvcur.options.focusPlay&&("visible"==document.visibilityState?Videoview.togglePlay(!0):"hidden"==document.visibilityState&&addEvent(window,"focus",function t(){Videoview.togglePlay(!0),removeEvent(window,"focus",t)})));var e=window.mvcur&&mvcur.player&&mvcur.player.el||ge("video_player");e&&e.focus();var i=Videoview.getMvData();i.tns_monetized?vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=pladform_videovk-playerload/"+irand(1,1e9):vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=platform_videovk-playerload/"+irand(1,1e9),i.kz&&(vkImage().src="//www.tns-counter.ru/V13a****vk_kz/ru/CP1251/tmsec=vkkz_videoloading/"+irand(1,1e9))},onVideoPlayProgress:function(e,i,t,o,a){var n=e+"_"+i;5e3>o&&cur.tnsStart!=n?(this.playerCallback.scoreCardCounter(),cur.tnsStart=n):o>a/2&&cur.tnsEnd!=n&&(cur.tnsEnd=n),window.mvcur&&mvcur.adData&&(mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&o>=5e3&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&o>=a/2&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&o>=.9*a&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0))},onVideoStreamPlaying:function(e,i){var t=Videoview.getPlayerObject();if(!(t&&t.isAutoplay&&t.isAutoplay())){window.Notifier&&setTimeout(function(){Notifier.lcSend("video_start")},0);var o=window.ap;o&&o.isPlaying()&&(o.pause(),o.pausedByVideo=vkNow())}},onVideoPlayStarted:function(e,i,t,o,a){var n=Videoview.getMvData(),r=Videoview.getVideoModule(e+"_"+i),d=cur.videoInlinePlayer&&cur.videoInlinePlayer.isAutoplay(),s="";if(window.Video&&Video.isInCatalog()){var l=window._videoLastInlined?domData(window._videoLastInlined[1],"playlist"):mvcur.options.playlistId,v=l?l.replace("cat_",""):"";s=Videocat.isTop3Playlist(v)?"featured":v}var c=void 0;switch(c=n&&n.inline?"inline":window.mvcur&&mvcur.options&&mvcur.options.playlistId?"layer_with_playlist":"layer",window.mvcur&&(mvcur.viewStartedTimestamp=vkNow()),ajax.post("al_video.php?act=video_view_started",{oid:e,vid:i,hash:t,module:r,videocat:s,quality:n?n.resolution:0,autoplay:d?1:0,inline:-1,player_view_type:c},{}),d&&cur.videoAutoplayStat&&cur.videoAutoplayStat.video==e+"_"+i&&!a&&ajax.post("al_video.php?act=autoplay_stat",{event:"start",start_time:vkNow()-cur.videoAutoplayStat.launched,preloaded:cur.videoAutoplayStat.preloaded?1:0,streaming_method:o,module:Videoview.getVideoModule()},{}),n.tns_monetized?vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=pladform_videovk-playerstart/"+irand(1,1e9):vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=platform_videovk-playerstart/"+irand(1,1e9),n.kz&&(vkImage().src="//www.tns-counter.ru/V13a****vk_kz/ru/CP1251/tmsec=vkkz_videostart/"+irand(1,1e9)),n.l_type){case 1:vkImage().src="//vk.com/rtrg?r=JQ6ueUeOxlSLb8IoA8ToayylOLgRkThaoFV0XVgG5qvS1x1xWrkfqAg73sYWJxwq9PXWucKtMS02J3CsGLZdmOMNj9dv9UCjDN4a3ShJZXcJFMhgfVwSoPWoxp*Y/LAFUnKz5*XBvDCQXeaygAqI*gY9gz*jWTXaOXyT2lSfIPY-";break;case 2:vkImage().src="//vk.com/rtrg?r=lD4OYmfC8ehvdc/8TL9AsAjM956qNaHyj20XV5mCNiTgYKQ6X*IXgwE8VbgqOf7rdbLJq7uCRBrdnFPTcUU2NjMgy8x4y6NWrYVwQMteNWh62XnLoNVZqobnsMMGm1OyTW09rhEkmiX5jqk3CI3JIIYbIbd8K7EC0ytQ4Kp4Kro-"}-33118207==e||-78630688==e?vkImage().src="//rs.mail.ru/d23694799.gif":-68420747==e||-121650415==e?vkImage().src="//rs.mail.ru/d25688137.gif":-18479452==e&&(vkImage().src="//rs.mail.ru/d25688115.gif")},onVideoPlayFinished:function(){if(window.mvcur&&mvcur.mvShown&&(mvcur.finished=!0,mvcur.mousemoved=!0,Videoview.moveCheck(),Videoview.logViewedPercentage()),window.mvcur&&mvcur.mvShown&&mvcur.adData)mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0);else{var e=Videoview.getMvData();e.tns_monetized?vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=pladform_videovk-playerend/"+irand(1,1e9):vkImage().src="//www.tns-counter.ru/V13a****pladform_ru/ru/CP1251/tmsec=platform_videovk-playerend/"+irand(1,1e9),e.kz&&(vkImage().src="//www.tns-counter.ru/V13a****vk_kz/ru/CP1251/tmsec=vkkz_videoend/"+irand(1,1e9))}},onVideoPlayError:function(){Videoview.isLayerShown()&&re("mv_live_gifts_block")},onVideoAdsLoadStarted:function(){vkImage().src="//www.tns-counter.ru/V13a****vk_com/ru/CP1251/tmsec=vk_videoload-license/"+irand(1,1e9)},onVideoAdsPlayStarted:function(){vkImage().src="//www.tns-counter.ru/V13a****vk_com/ru/CP1251/tmsec=vk_videostart-license/"+irand(1,1e9)},onVideoAdsPlayFinished:function(){vkImage().src="//www.tns-counter.ru/V13a****vk_com/ru/CP1251/tmsec=vk_videoend-license/"+irand(1,1e9)},onViewSegmentsChanged:function(e,i,t,o){if(t&&!cur.segmentsSaveProcess){var a="vsegs"+vk.id+"_"+e+"_"+i,n=ls.get(a);n&&n.ts&&vkNow()-n.ts>864e5&&(n=null,ls.remove(a));var r=n&&n.segments?n.segments.split("|")[2]:"";if(!r||t!=r){cur.segmentsSaveProcess=!0;var d={module:Videoview.getVideoModule(e+"_"+i),vid:i,oid:e,s:t,prev_s:n?n.segments:"",prev_sig:n?n.segmentsSig:"",hash:o},s=parseInt(cur.videoSearchPos);if(isNaN(s)||(d.search_pos=s),ajax.post("al_video.php?act=a_view_segments",d,{onDone:function(e,i,t){if(!(0>e)){e&&ls.set(a,{segments:e,segmentsSig:i,ts:vkNow()}),cur.segmentsSaveProcess=!1,t=intval(t);var o=parseInt(cur.videoSearchPos);t>0&&!isNaN(o)&&cur.videoSearchStats&&(cur.videoSearchStats.positions[o]=extend({viewedParts:0},cur.videoSearchStats.positions[o]),cur.videoSearchStats.positions[o].viewedParts++)}}}),cur.videoSearchStats&&(cur.videoSearchStats.totalViewedTime||(cur.videoSearchStats.totalViewedTime=0),cur.videoSearchStats.totalViewedTime+=mvcur.mvData.vsegsSize,!isNaN(s))){cur.videoSearchStats.positions[s]=extend({viewedSeconds:0},cur.videoSearchStats.positions[s]);var l=cur.videoSearchStats.positions[s].viewedSeconds;l=Math.min(mvcur.mvData.duration,l+mvcur.mvData.vsegsSize),cur.videoSearchStats.positions[s].viewedSeconds=l}}}},onLike:function(e){Videoview.like(null,!0),Videoview.sendPlayerStats(1,e)},onAdd:function(e,i,t){Videoview.addSmall(e,i),Videoview.sendPlayerStats(3,t)},onRemove:function(){Videoview.removeVideo()},onShare:function(e){Videoview.share(),Videoview.sendPlayerStats(2,e)},onSubscribe:function(e,i){Videoview.subscribeToAuthor(e,"player"),Videoview.sendPlayerStats(e?9:10,i)},onDonate:function(){Videoview.showDonateBox()},isInLayer:function(e){return Videoview.isLayerShown(e)},onLiveViewersCountChange:function(e,i,t){Videoview.isLayerShown(e)&&Videoview.updateLiveViewersCount(i,t)},onLiveStarted:function(e){return Videoview.isLayerShown(e)?(Videoview.reload(),!0):void 0},onLiveEnded:function(e){Videoview.isLayerShown(e)&&(hide("mv_publish"),hide("mv_live_gifts_block"),val("mv_views",getLang("video_live_finished")))},onAdPostStat:function(e,i){window.Wall&&Wall.triggerAdPostStat(e,i)}}},function(e,i,t){"use strict";function o(e){return"string"==typeof e||"number"==typeof e?document.getElementById(e):e}function a(e,i){return i=o(i)||document,i.getElementsByTagName(e)}function n(e,i){return i=o(i)||document,i.querySelector&&i.querySelector(e)||a(e,i)[0]}function r(e,i,t){i=o(i)||document,t=t||"*";var n=[];if(i.querySelectorAll&&"*"!=t)return i.querySelectorAll(t+"."+e);if(i.getElementsByClassName){var r=i.getElementsByClassName(e);if("*"!=t){t=t.toUpperCase();for(var d=0,s=r.length;s>d;++d)r[d].tagName.toUpperCase()==t&&n.push(r[d])}else n=Array.prototype.slice.call(r);return n}for(var l=a(t,i),v=new RegExp("(^|\\s)"+e+"(\\s|$)"),d=0,s=l.length;s>d;++d)v.test(l[d].className)&&n.push(l[d]);return n}function d(e,i,t){return i=o(i)||document,t=t||"*",i.querySelector&&i.querySelector(t+"."+e)||r(e,i,t)[0]}function s(e,i,t){if(i=o(i),!i)return null;for(;t!==i&&(i=i.parentNode);)if(ee(i,e))return i;return null}function l(e,i){return(i||document).querySelectorAll(e)}function v(e,i){return(i||document).querySelector(e)}function c(e,i){return ee(i,e)?i:s(e,i)}function u(e,i){return e=e.toUpperCase(),i.nodeType==Node.ELEMENT_NODE&&i.tagName.toUpperCase()==e?i:m(e,i)}function m(e,i){if(i=o(i),!i)return null;for(e=e.toUpperCase();i=i.parentNode;)if(i.tagName&&i.tagName.toUpperCase()==e)return i;return null}function _(e,i,t){var o=document.createElement(e);return i&&extend(o,i),t&&le(o,t),o}function p(e){return e=o(e),e&&e.parentNode&&e.parentNode.removeChild(e),e}function h(e){return S(_("div",{innerHTML:e}))}function f(e){return D(_("div",{innerHTML:e}))}function w(e,i){return each(i,function(i,t){e=e.replace(new RegExp("%"+i+"%","g"),("undefined"==typeof t?"":t).toString().replace(/\$/g,"&#036;"))}),e}function g(e){return"https:"!=locProtocol?e:(e=e.replace(/http:\/\/(cs(\d+)\.vk\.me\/c(\d+)\/)/gi,"https://$1"),e=e.replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/c(\d+)\/(v\d+\/|[a-z0-9\/_:\-]+\.jpg)/gi,"https://pp.vk.me/c$3/$4"),e=e.replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\/([a-z0-9\/_:\-]+\.jpg)/gi,"https://pp.vk.me/c$1/$3"),e=e.replace(/http:\/\/cs(\d+)\.(userapi\.com|vk\.com|vk\.me|vkontakte\.ru)\//gi,"https://ps.vk.me/c$1/"),e=e.replace(/http:\/\/video(\d+)\.vkadre\.ru\//gi,"https://ps.vk.me/v$1/"))}function y(e,i){return isString(i)&&(i=h(i)),x(e).replaceChild(i,e),i}function V(e,i){for(i=i?"previousSibling":"nextSibling";e&&!e.tagName;)e=e[i];return e}function b(e){return V((e||{}).nextSibling)}function C(e){return V((e||{}).previousSibling,1)}function S(e){return V((e||{}).firstChild)}function k(e){return V((e||{}).lastChild,1)}function x(e){return(e||{}).parentNode}function D(e){for(var i=[],t=e.childNodes,o=0;o<t.length;o++)t[o].tagName&&i.push(t[o]);return i}function L(e,i){var t=x(i);return t&&t.insertBefore(e,i)}function T(e,i){var t=x(i);return t&&t.insertBefore(e,b(i))}function P(e,i){return e?d(i,e):e}function B(e,i,t){return e?"undefined"!=typeof t?(null===t?e.removeAttribute("data-"+i):e.setAttribute("data-"+i,t),t):e.getAttribute("data-"+i):null}function E(e){for(var i=0;null!=(e=C(e));)i++;return i}function I(e,i){do e=x(e);while(e&&!z(e,i));return e}function M(e,i,t){for(var o=null;null===o&&e;)e=-1===t?C(e):b(e),e&&z(e,i)&&(o=e);return o}function z(e,i){if(e=o(e),!e||e==document)return!1;var t=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||function(e){for(var i=(this.parentNode||this.document||this.ownerDocument).querySelectorAll(e),t=i.length;--t>=0&&i[t]!==this;);return t>-1};return t.call(e,i)}function A(e){return z(e,":hover")}function N(e,i){var t=o(e);if(i=o(i),!e||!i)return!1;for(;t=t.parentNode;)if(t==i)return!0;return!1}function R(){var e=browser.msie6?o("PageContainer"):document.body,i=document.documentElement;return[e.scrollLeft||i.scrollLeft||window.pageXOffset||0,e.scrollTop||i.scrollTop||window.pageYOffset||0,i.clientWidth||e.clientWidth||0,i.clientHeight||e.clientHeight||0]}function j(e,i){i=i||{};for(var t=i.fromEl||x(e),o=i.positions||["relative","absolute","fixed"];t&&t!=bodyNode;){var a=se(t,"position");if(inArray(a,o)&&(!i.noOverflow||"hidden"!=se(t,"overflow")))break;t=x(t)}return t}function H(e,i){e=o(e);for(var t,a,n,r,d=e;d&&d.tagName&&d!==bodyNode&&(t=se(d,"position"),a=se(d,"overflow"),n=se(d,"transform"),!i||!browser.mozilla||"page_wrap"==d.id||d===e||"visible"===a||("static"===t?r&&"relative"!==r:"fixed"===r));)"none"!==n?r=void 0:"static"!==t&&"fixed"!==r&&(r=t),d=x(d);return d}function F(e){var i=arguments.length;if(i>1)for(var t=0;i>t;t++)F(arguments[t]);else if(e=o(e),e&&e.style){var a=e.olddisplay,n="block",r=e.tagName.toLowerCase();e.style.display=a||"","none"===se(e,"display")&&(n=ee(e,"inline")||ee(e,"_inline")?"inline":ee(e,"_inline_block")?"inline-block":"tr"!==r||browser.msie?"table"!==r||browser.msie?"block":"table":"table-row",e.style.display=e.olddisplay=n)}}function O(e){var i=arguments.length;if(i>1)for(var t=0;i>t;t++)O(arguments[t]);else if(e=o(e),e&&e.style){var a=se(e,"display");e.olddisplay="none"!=a?a:"",e.style.display="none"}}function W(e){return e=o(e),e&&e.style?"none"!=se(e,"display"):!1}function q(){return window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight}function U(e,i,t){e=o(e),t=t||0;var a=Q(e)[1],n=$(e)[1],r=window,d=document.documentElement,s=Math.max(intval(r.innerHeight),intval(d.clientHeight)),l=o("page_header_cont"),v=d.scrollTop||bodyNode.scrollTop||window.scrollY||0,c=vk.staticheader?Math.max(0,$(l)[1]-v):$(l)[1];if(i){if(v+c+t>a+n)return a+n-v-c-t;if(a>v+s-t)return a-v-s+t}else{if(v+c+t>a)return a-v-c-t;if(a+n>v+s-t)return a+n-v-s+t}return 0}function X(e,i){return void 0===i&&(i=!W(e)),i?F(e):O(e),i}function Y(e){return"undefined"!=typeof e.getBoundingClientRect}function G(e,i){var t;if(i&&"inline"==se(e,"display")){var o=e.getClientRects();t=o&&o[0]||e.getBoundingClientRect()}else t=e.getBoundingClientRect();return t}function Q(e,i){if(e=o(e),!e)return[0,0];var t,a,n={top:0,left:0},r=e.ownerDocument;return r?(t=r.documentElement,Y(e)&&(n=G(e,!0)),a=r==r.window?r:9===r.nodeType?r.defaultView||r.parentWindow:!1,[n.left+(i?0:a.pageXOffset||t.scrollLeft)-(t.clientLeft||0),n.top+(i?0:a.pageYOffset||t.scrollTop)-(t.clientTop||0)]):[0,0]}function K(e){return null!=e&&e===e.window}function $(e,i,t){e=o(e);var a,n=[0,0],r=document.documentElement;if(i&&"border-box"===se(e,"boxSizing")&&(i=!1),e==document)n=[Math.max(r.clientWidth,bodyNode.scrollWidth,r.scrollWidth,bodyNode.offsetWidth,r.offsetWidth),Math.max(r.clientHeight,bodyNode.scrollHeight,r.scrollHeight,bodyNode.offsetHeight,r.offsetHeight)];else if(e){var d=function(){if(n=Y(e)&&(a=G(e,t))&&void 0!==a.width?[a.width,a.height]:[e.offsetWidth,e.offsetHeight],i){each(n,function(i,t){var o=i?["Top","Bottom"]:["Left","Right"];each(o,function(){n[i]-=parseFloat(se(e,"padding"+this))||0,n[i]-=parseFloat(se(e,"border"+this+"Width"))||0})})}};if(W(e))d();else{var s={position:"absolute",visibility:"hidden",display:"block"},l={},v=!1;e.style.cssText.indexOf("!important")>-1&&(v=e.style.cssText),each(s,function(i,t){l[i]=e.style[i],e.style[i]=t}),d(),each(s,function(i,t){e.style[i]=l[i]}),v&&(e.style.cssText=v)}}return n}function J(e){return $(e)[0]}function Z(e){return $(e)[1]}function ee(e,i){return e=o(e),e&&1===e.nodeType&&(" "+e.className+" ").replace(window.whitespaceRegex," ").indexOf(" "+i+" ")>=0?!0:!1}function ie(e,i){(e=o(e))&&!ee(e,i)&&(e.className=(e.className?e.className+" ":"")+i)}function te(e,i){return setTimeout(ie.pbind(e,i),0)}function oe(e,i){(e=o(e))&&(e.className=trim((e.className||"").replace(new RegExp("(\\s|^)"+i+"(\\s|$)")," ")))}function ae(e,i){return setTimeout(oe.pbind(e,i),0)}function ne(e,i,t){return void 0===t&&(t=!ee(e,i)),(t?ie:oe)(e,i),t}function re(e,i,t){return void 0===t&&(t=!ee(e,i)),(t?te:ae)(e,i),t}function de(e,i,t){oe(e,i),ie(e,t)}function se(e,i,t){if(e=o(e),isArray(i)){var a={};return each(i,function(i,t){a[t]=se(e,t)}),a}if(!e)return"";if(void 0===t&&(t=!0),!t&&"opacity"==i&&browser.msie){var n=e.style.filter;return n?n.indexOf("opacity=")>=0?parseFloat(n.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!t&&e.style&&(e.style[i]||"height"==i))return e.style[i];var r,d=document.defaultView||window;if(d.getComputedStyle){i=i.replace(/([A-Z])/g,"-$1").toLowerCase();var s=d.getComputedStyle(e,null);s&&(r=s.getPropertyValue(i))}else if(e.currentStyle){if("opacity"==i&&browser.msie){var n=e.currentStyle.filter;return n&&n.indexOf("opacity=")>=0?parseFloat(n.match(/opacity=([^)]*)/)[1])/100+"":"1"}var l=i.replace(/\-(\w)/g,function(e,i){return i.toUpperCase()});r=e.currentStyle[i]||e.currentStyle[l],"auto"==r&&(r=0),r=(r+"").split(" "),each(r,function(i,t){if(!/^\d+(px)?$/i.test(t)&&/^\d/.test(t)){var o=e.style,a=o.left,n=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,o.left=t||0,r[i]=o.pixelLeft+"px",o.left=a,e.runtimeStyle.left=n}}),r=r.join(" ")}if(t&&("width"==i||"height"==i)){var v=$(e,!0)[{width:0,height:1}[i]];r=(intval(r)?Math.max(floatval(r),v):v)+"px"}return r}function le(e,i,t){if(e=o(e)){if("object"==("undefined"==typeof i?"undefined":Se(i)))return each(i,function(i,t){le(e,i,t)});if("opacity"==i)browser.msie&&((t+"").length?1!==t?e.style.filter="alpha(opacity="+100*t+")":e.style.filter="":e.style.cssText=e.style.cssText.replace(/filter\s*:[^;]*/gi,""),e.style.zoom=1),e.style.opacity!==t&&(e.style.opacity=t);else try{var a="number"==typeof t;a&&/height|width/i.test(i)&&(t=Math.abs(t)),t=a&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(i)?t+"px":t,e.style[i]!==t&&(e.style[i]=t)}catch(n){debugLog("setStyle error: ",[i,t],n)}}}function ve(e,i,t){setTimeout(le.pbind(e,i,t),0)}function ce(e,i,t){var a=ue(e,"pseudo-id");a||(ue(e,"pseudo-id",a=irand(1e8,999999999)),ie(e,"_pseudo_"+a));var n=i+"-style-"+a,r=o(n),d="._pseudo_"+a+":"+i+"{";r||(r=headNode.appendChild(_("style",{id:n,type:"text/css"}))),each(t,function(e,i){d+=e+": "+i+" !important;"}),d+="}",r.sheet?(r.sheet.cssRules.length&&r.sheet.deleteRule(0),r.sheet.insertRule(d,0)):r.styleSheet&&(r.styleSheet.cssText=d)}function ue(e,i,t){if(!e)return!1;var o,a=e[vkExpand];return a||(a=e[vkExpand]=++vkUUID),t!==o&&(vkCache[a]||(vkCache[a]={},__debugMode&&(vkCache[a].__elem=e)),vkCache[a][i]=t),i?vkCache[a]&&vkCache[a][i]:a}function me(e,i,t){return e=o(e),"undefined"==typeof t?e.getAttribute(i):(e.setAttribute(i,t),t)}function _e(e){for(var i=0,t=arguments.length;t>i;++i){var o=arguments[i];if(void 0!==e[o])try{delete e[o]}catch(a){try{e.removeAttribute(o)}catch(a){}}}}function pe(e,i){var t=e?e[vkExpand]:!1;if(t)if(i){if(vkCache[t]){delete vkCache[t][i],i="";var o=0;for(i in vkCache[t])if("__elem"!==i){o++;break}o||pe(e)}}else removeEvent(e),_e(e,vkExpand),delete vkCache[t]}function he(){for(var e=arguments,i=0;i<e.length;++i){var t=o(e[i]);t&&(pe(t),_e(t,"btnevents"))}}function fe(e,i,t){if(e=o(e),e&&!e.titleSet){if(i||(i=e),i.scrollWidth>i.clientWidth)e.setAttribute("title",t||e.innerText||e.textContent);else{var a=n("b",e);a&&a.scrollWidth>a.clientWidth?e.setAttribute("title",t||e.innerText||e.textContent):e.removeAttribute("title")}e.titleSet=1}}function we(){var e=o("zoom_test_1")||document.body.appendChild(_("div",{id:"zoom_test_1"},{left:"10%",position:"absolute",visibility:"hidden"})),i=o("zoom_test_2")||document.body.appendChild(_("div",{id:"zoom_test_2"},{left:e.offsetLeft+"px",position:"absolute",visibility:"hidden"}));return i.offsetLeft/e.offsetLeft}function ge(e,i,t){return(e=o(e))?(void 0!==i&&(e.setValue?(e.setValue(i),!t&&e.phonblur&&e.phonblur()):"INPUT"==e.tagName||"TEXTAREA"==e.tagName?e.value=i:void 0!==e.emojiId&&window.Emoji?Emoji.val(e,i):e.innerHTML=i,!t&&triggerEvent(e,"valueChanged")),e.getValue?e.getValue():("INPUT"==e.tagName||"TEXTAREA"==e.tagName?e.value:e.innerHTML)||""):void 0}function ye(e,i,t){e=o(e);try{if(e.focus(),(void 0===i||i===!1)&&(i=e.value.length),(void 0===t||t===!1)&&(t=i),e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",i),a.select()}else e.setSelectionRange&&e.setSelectionRange(i,t)}catch(n){}}function Ve(e,i,t){for(e=o(e),t=t||999;e&&!i(e);){if(t--,0==t)return!1;try{if(e=x(e),e==document)break}catch(a){e=!1}}return e}function be(e){return xe?void 0:window.document.title=e}function Ce(e){xe=e,e&&window.cur&&window.cur.destroy.push(function(){Ce(!1)})}Object.defineProperty(i,"__esModule",{value:!0});var Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.ge=o,i.geByTag=a,i.geByTag1=n,i.geByClass=r,i.geByClass1=d,i.gpeByClass=s,i.domQuery=l,i.domQuery1=v,i.domClosest=c,i.domClosestByTag=u,i.gpeByTag=m,i.ce=_,i.re=p,i.se=h,i.sech=f,i.rs=w,i.psr=g,i.domReplaceEl=y,i.domEL=V,i.domNS=b,i.domPS=C,i.domFC=S,i.domLC=k,i.domPN=x,i.domChildren=D,i.domInsertBefore=L,i.domInsertAfter=T,i.domByClass=P,i.domData=B,i.domChildIndex=E,i.domCA=I,i.domClosestSibling=M,i.matchesSelector=z,i.isHover=A,i.isAncestor=N,i.getScroll=R,i.domClosestPositioned=j,i.domClosestOverflowHidden=H,i.show=F,i.hide=O,i.isVisible=W,i.clientHeight=q,i.getClientRectOffsetY=U,i.toggle=X,i.boundingRectEnabled=Y,i.getXYRect=G,i.getXY=Q,i.isWindow=K,i.getSize=$,i.getW=J,i.getH=Z,i.hasClass=ee,i.addClass=ie,i.addClassDelayed=te,i.removeClass=oe,i.removeClassDelayed=ae,i.toggleClass=ne,i.toggleClassDelayed=re,i.replaceClass=de,i.getStyle=se,i.setStyle=le,i.setStyleDelayed=ve,i.setPseudoStyle=ce,i.data=ue,i.attr=me,i.removeAttr=_e,i.removeData=pe,i.cleanElems=he,i.setTitle=fe,i.getZoom=we,i.val=ge,i.elfocus=ye,i.traverseParent=Ve,i.setDocumentTitle=be,i.lockDocumentTitle=Ce;var ke=t(10);window.cf=function(e){var i=e.createDocumentFragment(),t=e.createElement("div"),o=e.createRange&&e.createRange();return i.appendChild(t),o&&o.selectNodeContents(t),o&&o.createContextualFragment?function(i){return i?o.createContextualFragment(i):e.createDocumentFragment()}:function(i){if(!i)return e.createDocumentFragment();t.innerHTML=i;for(var o=e.createDocumentFragment();t.firstChild;)o.appendChild(t.firstChild);return o}}(document),window.whitespaceRegex=/[\t\r\n\f]/g,window.cssTransformProp=function(){var e=document.createElement("div");if(null==e.style.transform){var i=["Webkit","Moz","ms"];for(var t in i)if(void 0!==e.style[i[t]+"Transform"])return i[t]+"Transform"}return"transform"}(),window.vkExpand=window.vkExpand||"VK"+(0,ke.vkNow)(),window.vkUUID=window.vkUUID||0,window.vkCache=window.vkCache||{};var xe=!1;window.ge=o,window.geByTag=a,window.geByTag1=n,window.geByClass=r,window.geByClass1=d,window.gpeByClass=s,window.domQuery=l,window.domQuery1=v,window.domClosest=c,window.ce=_,window.re=p,window.se=h,window.sech=f,
window.rs=w,window.psr=g,window.domReplaceEl=y,window.domEL=V,window.domNS=b,window.domPS=C,window.domFC=S,window.domLC=k,window.domPN=x,window.domChildren=D,window.domInsertBefore=L,window.domInsertAfter=T,window.domByClass=P,window.domData=B,window.domChildIndex=E,window.domCA=I,window.domClosestSibling=M,window.matchesSelector=z,window.isHover=A,window.isAncestor=N,window.getScroll=R,window.domClosestPositioned=j,window.domClosestOverflowHidden=H,window.show=F,window.hide=O,window.isVisible=W,window.clientHeight=q,window.getClientRectOffsetY=U,window.toggle=X,window.boundingRectEnabled=Y,window.getXYRect=G,window.getXY=Q,window.isWindow=K,window.getSize=$,window.hasClass=ee,window.addClass=ie,window.addClassDelayed=te,window.removeClass=oe,window.removeClassDelayed=ae,window.toggleClass=ne,window.toggleClassDelayed=re,window.replaceClass=de,window.getStyle=se,window.setStyle=le,window.setStyleDelayed=ve,window.setPseudoStyle=ce,window.data=ue,window.attr=me,window.removeAttr=_e,window.removeData=pe,window.cleanElems=he,window.setTitle=fe,window.getZoom=we,window.val=ge,window.elfocus=ye,window.traverseParent=Ve,window.getH=Z,window.getW=J,window.domClosestByTag=u,window.setDocumentTitle=be,window.lockDocumentTitle=Ce},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={VIDEOS_LIMIT:100,lists:{},blockTpl:'\n<div class="mv_playlist" id="video_mvpl" onmouseenter="VideoPlaylist.toggleHeaderButtons(this, true)" onmouseleave="VideoPlaylist.toggleHeaderButtons(this, false)">\n  <div class="mv_playlist_header clear_fix">\n    <div class="mv_playlist_header_buttons_wrap unshown">\n      <div id="mv_pl_autoplay" class="mv_playlist_header_btn %autoplayBtnClass%" onmouseover="VideoPlaylist.showAutoplayTooltip(this);" onclick="VideoPlaylist.toggleAutoplay(this)"><div class="mv_playlist_header_autoplay_icon"></div></div>\n      <div id="mv_pl_reverse" class="mv_playlist_header_btn _opaque" onmouseover="VideoPlaylist.showReverseTooltip(this);" onclick="VideoPlaylist.toggleReverse(this)"><div class="mv_playlist_header_reverse_icon"></div></div>\n    </div>\n    <div class="mv_playlist_header_title">%title%</div>\n  </div>\n  <div class="mv_playlist_list">\n    <div class="mv_playlist_list_cont">\n      %items%\n    </div>\n  </div>\n</div>\n  ',blockItemTpl:'\n<a class="mv_playlist_item %itemClass%" id="mv_playlist_video%vid%" onclick="return VideoPlaylist.showVideo(\'%vid%\', event);" data-vid="%vid%" href="/video%vid%">\n  <div class="mv_playlist_item_thumb" style="background-image: url(\'%thumb%\');">\n    <div class="mv_playlist_item_duration">%duration%</div>\n  </div>\n  <div class="mv_playlist_item_info">\n    <div class="mv_playlist_item_title">%title%</div>\n    <div class="mv_playlist_item_views">%views%</div>\n  </div>\n</a>\n  ',toggleHeaderButtons:function(e,i){toggleClass(domByClass(e,"mv_playlist_header_buttons_wrap"),"unshown",!i)},showReverseTooltip:function(e){showTooltip(e,{text:getLang("video_playlist_reverse_tt"),shift:[7,7,0],showdt:0,black:1})},showAutoplayTooltip:function(e){var i=VideoPlaylist.isAutoplayEnabled(),t="video_playlist_autoplay_"+(i?"disable":"enable")+"_tt",o=getLang(t);showTooltip(e,{text:o,shift:[7,7,0],showdt:0,black:1})},toggleAutoplay:function(e){var i=!VideoPlaylist.isAutoplayEnabled();toggleClass(e,"_active",i),i?ls.remove("video_playlist_autoplay_disabled"):ls.set("video_playlist_autoplay_disabled",1),tooltips.destroy(e),VideoPlaylist.showAutoplayTooltip(e)},isAutoplayEnabled:function(){return!ls.get("video_playlist_autoplay_disabled")},toggleReverse:function(e){var i=VideoPlaylist.getCurList();i&&(i.reversed=!i.reversed,toggleClass(e,"_active",i.reversed),VideoPlaylist.updateBlockList(i.id))},buildBlock:function(e,i,t){var o=VideoPlaylist.getBlock(),a=o?data(o,"playlist"):!1;if(a&&a.id==e&&!t)return o;VideoPlaylist.removeBlock();var n=VideoPlaylist.getList(e,i);if(!n||n.list.length<=1)return!1;var r=trim(VideoPlaylist.blockTpl),d=VideoPlaylist.buildBlockList(n),s=se(rs(r,{items:d,title:n.title||"",autoplayBtnClass:VideoPlaylist.isAutoplayEnabled()?"_active":""}));return data(s,"playlist",n),this._block=s,s},buildBlockList:function(e){for(var i=trim(VideoPlaylist.blockItemTpl),t=function(){return e.reversed?e.list.length-1:0},o=function(i){return e.reversed?i>=0:i<e.list.length},a=function(i){return e.reversed?--i:++i},n="",r=t();o(r);r=a(r)){var d=e.list[r],s=void 0;if(isArray(d)){var l=d[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+d[VideoConstants.VIDEO_ITEM_INDEX_ID];s={vid:l,thumb:d[VideoConstants.VIDEO_ITEM_INDEX_THUMB],title:d[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:d[VideoConstants.VIDEO_ITEM_INDEX_DURATION],views:getLang("video_N_views_list",d[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]||1,!0),itemClass:l==e.current?"mv_playlist_item_active":""}}else s=extend({},d,{itemClass:d.vid==e.current?"mv_playlist_item_active":""});n+=rs(i,s)}return n},updateBlockList:function(e){var i=VideoPlaylist.getCurList();if(i&&i.id==e){var t=VideoPlaylist.getBlock(),o=geByClass1("mv_playlist_list_cont",t),a=VideoPlaylist.buildBlockList(i);val(o,a);var n=data(t,"sb");n&&n.update(),VideoPlaylist.setCurVideo(i.current),VideoPlaylist.updateControls()}},getBlock:function(){return this._block},removeBlock:function(){var e=data(this._block,"sb");e&&e.destroy(),re(this._block),removeData(this._block),this._block=null,VideoPlaylist.toggleStateClasses(),VideoPlaylist.updateControls()},setCurVideo:function(e,i){function t(){var e=VideoPlaylist.getBlock();if(e){var i=data(e,"sb");i&&i.update()}}var o=VideoPlaylist.getBlock();if(o){var a=data(o,"playlist");if(a){e&&(a.current=e);var n=domByClass(o,"mv_playlist_item_active");if(e&&(removeClass(n,"mv_playlist_item_active"),n=ge("mv_playlist_video"+e),addClass(n,"mv_playlist_item_active")),n){var r=geByClass1("mv_playlist_list",o),d=getXY(n)[1],s=getSize(n)[1],l=getXY(r)[1],v=getSize(r)[1],c=d-l;if(0>c||c+s>v){var u=r.scrollTop+d-l-v/2+s/2;r.scrollTop!=u&&(i?animate(r,{scrollTop:u,transition:window.Fx.Transitions.easeOutCubic},450,t):(r.scrollTop=u,t()))}VideoPlaylist._queueNextVideo(e)}}}},getList:function(e,i){if(this.lists[e])return this.lists[e];var t=/^wall_-?\d+$/,o=/^post_-?\d+_\d+$/,a=/^cat_(\d|[\w_])+$/,n=/^-?\d+_-?\d+$/;if(t.test(e))return cur.wallVideos&&cur.wallVideos[e]&&this.uniqList(cur.wallVideos[e]);if(o.test(e))return cur.pageVideosList&&cur.pageVideosList[e];if(a.test(e))return cur.catVideosList&&cur.catVideosList[e];if(n.test(e)){var r=e.split("_"),d=r.ownerId,s=r.albumId,l=void 0,v=void 0,c=void 0;if(-2==s?(l="all",v=cur.playlistAddedTitle):-1==s?(l="uploaded",v=cur.playlistUploadedTitle):(l="album_"+s,v=cur.playlistTitle),each([cur.silentLoaded,cur.pageVideosList],function(e,i){return i&&i[d]&&i[d][l]?(c=i[d][l],!1):void 0}),c&&c.length){var u=void 0;if(i)for(u=c.length;--u;){var m=c[u];if(m[0]+"_"+m[1]==i)break}else u=0;if(c.length>VideoPlaylist.VIDEOS_LIMIT){var _=positive(u-VideoPlaylist.VIDEOS_LIMIT/2),p=_+VideoPlaylist.VIDEOS_LIMIT;p>c.length&&(_=positive(c.length-VideoPlaylist.VIDEOS_LIMIT),p=c.length),c=c.slice(_,p)}return{id:e,title:v,list:c}}}},getCurList:function(){var e=VideoPlaylist.getBlock();return e?data(e,"playlist"):void 0},getCurListId:function(){var e=VideoPlaylist.getCurList();return e?e.id:void 0},addList:function(e){this.lists[e.id]=e},extendList:function(e,i){if(!this.lists[e])return!1;for(var t=this.lists[e].list,o=[],a={},n=0,r=0;;)if(t[n]&&i[r]&&t[n].vid==i[r].vid)a[t[n].vid]||(o.push(t[n]),a[t[n].vid]=1),++n,++r;else if(t[n])a[t[n].vid]||(o.push(t[n]),a[t[n].vid]=1),++n;else{if(!i[r])break;a[i[r].vid]||(o.push(i[r]),a[i[r].vid]=1),++r}return this.lists[e].list=o,this.lists[e]},uniqList:function(e){for(var i,t={},o=0;i=e.list[o];++o)t[i.vid]?e.list.splice(o,1):t[i.vid]=!0;return e},isCollapsed:function(){var e=VideoPlaylist.getBlock();return!(!e||!data(e,"collapsed"))},toggle:function(e,i){if("undefined"==typeof e&&(e=VideoPlaylist.isCollapsed()),!mvcur.minimized||!e){var t=VideoPlaylist.getBlock();if(t&&VideoPlaylist.isCollapsed()!=!e)return data(t,"collapsed",!e),VideoPlaylist.toggleStateClasses(),Videoview.playerOnResize(),Videoview.updateReplyFormPos(),e&&(VideoPlaylist.updateScrollbar(),VideoPlaylist.setCurVideo()),!1}},toggleStateClasses:function(){var e=!!VideoPlaylist.getBlock(),i=Videoview.isMinimized(),t=VideoPlaylist.isCollapsed();toggleClass("mv_box","_has_playlist",e&&!i),toggleClass("mv_box","_hide_playlist",e&&!i&&t);var o="";e&&(o=getLang(t?"video_aria_expand_playlist":"video_aria_minimize_playlist")),attr("mv_top_pl_toggle","aria-label",o)},updateScrollbar:function(){var e=VideoPlaylist.getBlock();if(e){var i=data(e,"sb");if(i)i.update(!0,!0);else{var t=geByClass1("mv_playlist_list",e),o=new Scrollbar(t,{prefix:"mv_pl_",nokeys:!0,padding:0});data(e,"sb",o)}}},updateControls:function(){var e=VideoPlaylist.getCurList(),i=VideoPlaylist.getVideoIndex();e&&e.reversed&&(i=e.list.length-i-1),toggle("mv_pl_prev",!!e&&i>0),toggle("mv_pl_next",!!e&&i<e.list.length-1)},showVideo:function(e){function i(i,t){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}(function(e,i){if(i&&checkEvent(i))return!0;var t=VideoPlaylist.getCurList();if(t){if(VideoPlaylist.saveScrollPos(),mvcur.options.params&&"direct"==mvcur.options.params.module&&mvcur.mvPrevLoc&&Videoview.backLocation(),t.loaded&&t.loaded.vid==e){var o=t.loaded;Videoview.show(null,e,o.listId,extend(o.options,{playlistId:t.id})),Videoview.showVideo.apply(Videoview,o.hubData);var a=mvcur.preloadStatsHashes?mvcur.preloadStatsHashes[e]:"";a&&ajax.post("al_video.php?act=a_inc_preload_stats",{stat_preload_hash:a}),t.loaded=!1}else{var n=VideoPlaylist.getVideoIndex(e),r=t.reversed?t.list.length-1-n:n,d=r<t.list.length-1?1:0;showVideo(e,"",{autoplay:1,playlistId:t.id,addParams:{force_no_repeat:1,show_next:d},module:Videoview.getVideoModule()})}return!1}}),saveScrollPos:function(){var e=VideoPlaylist.getBlock(),i=domByClass(e,"mv_playlist_list");data(e,"savedScrollTop",i.scrollTop)},restoreScrollPos:function(){var e=VideoPlaylist.getBlock(),i=domByClass(e,"mv_playlist_list"),t=data(e,"savedScrollTop");t&&(i.scrollTop=t)},_queueNextVideo:function(e){var i=VideoPlaylist.getCurList();if(i){e=e||i.current;var t=VideoPlaylist._getNextVideoIndex(e);if(-1!=t){var o=i.list[t],a=isArray(o)?o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+o[VideoConstants.VIDEO_ITEM_INDEX_ID]:o.vid,n=isArray(o)?"":o.hash;if(i.queued!=a&&(!i.loaded||i.loaded.vid!=a)){i.loaded=!1,i.queued=a;var r=(i.reversed?i.list.length-t:t)<i.list.length-1?1:0;showVideo(a,n,{hidden:function(e,t,o,a){i.queued==a&&(i.loaded={vid:a,hubData:e,options:t,listId:o}),i.queued=!1},module:Videoview.getVideoModule(a),addParams:{autoplay:1,force_no_repeat:1,preload:1,show_next:r,playlist_id:i.id}})}}}},getNextVideos:function(){var e=[];if(!(VideoPlaylist.isAutoplayEnabled()||window.mvcur&&mvcur.player))return e;var i=VideoPlaylist.getCurList(),t=VideoPlaylist._getNextVideoIndex();if(!i||0>t)return e;for(;e.length<3&&t>=0&&t<i.list.length;){var o=i.list[t],a=void 0;a=isArray(o)?{vid:o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+o[VideoConstants.VIDEO_ITEM_INDEX_ID],thumb:o[VideoConstants.VIDEO_ITEM_INDEX_THUMB],views:getLang("video_N_views_list",o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],!0),title:o[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:o[VideoConstants.VIDEO_ITEM_INDEX_DURATION]}:o,e.push(a),t+=i.reversed?-1:1}return e},prevVideo:function t(){var e=VideoPlaylist.getCurList();if(e){var i=VideoPlaylist.getVideoIndex()+(e.reversed?1:-1);if(!(0>i)){var t=e.list[i],o=isArray(t)?t[0]+"_"+t[1]:t.vid;VideoPlaylist.showVideo(o)}}},nextVideo:function o(){var e=VideoPlaylist.getCurList();if(e){var i=VideoPlaylist._getNextVideoIndex();if(!(0>i)){var o=e.list[i],t=isArray(o)?o[0]+"_"+o[1]:o.vid;VideoPlaylist.showVideo(t)}}},getVideoIndex:function(e){var i=VideoPlaylist.getCurList();if(!i)return-1;if(e||(e=i.current),!e)return-1;var t=-1;return each(i.list,function(i,o){var a=isArray(o)?o[0]+"_"+o[1]:o.vid;return a==e?(t=i,!1):void 0}),t},_getNextVideoIndex:function(e){var i=VideoPlaylist.getCurList();if(!i)return-1;var t=VideoPlaylist.getVideoIndex(e);if(0>t)return 0;var o=t+(i.reversed?-1:1);return o>=0&&o<i.list.length?o:-1}}},function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={DEFAULT_COMMENT_MAX_LENGTH:300,init:function(e){function i(e){e=JSON.parse(e),e&&"success"==e.status?(VideoDonate.apiData=e.data,VideoDonate.initForm()):t()}function t(){curBox().hide(),showFastBox(getLang("global_error"),getLang("global_error_occured"))}VideoDonate.params={prefilled:e.prefilled,videoId:e.video_raw,votesHash:e.votes_hash,referrer:e.referrer,payerId:e.payer_id},ajax.plainpost(e.api_url,"",i,t,!0)},initForm:function(){var e=VideoDonate.apiData,i=floatval(e.user_data.donation_mins.RUB),t=Math.ceil(i/vk.vcost);if(VideoDonate.params.votesHash&&t<=vk.balance){var o=[["votes",getLang("video_donate_box_currency_votes")],["rubles",getLang("video_donate_box_currency_rubles")]];VideoDonate.currencyDropdown=new Dropdown(ge("video_donate_amount_currency"),o,{multiselect:!1,onChange:VideoDonate.onChooseCurrency,selectedItems:"votes",width:150,big:!0}),addClass("video_donate_amount_wrap","video_donate_can_choose_currency"),VideoDonate.onChooseCurrency("votes")}else VideoDonate.onChooseCurrency("rubles");var a=ge("video_donate_comment");a.onkeydown=a.onkeyup=a.onchange=VideoDonate.checkCommentLength,toggle("video_donate_widget_offline",!e.user_data.alert_widget_is_online),ge("video_donate_basic_submit").onclick=VideoDonate.submitBasicForm;var n=geByClass("radiobtn","video_donate_pay_methods");radioBtns.video_donate_pay_method={els:Array.prototype.slice.apply(n)};var r=ls.get("video_donate_pay_method")||"";each(n,function(e,i){i.onclick=function(e){VideoDonate.onChoosePayMethod(e.currentTarget)},domData(i,"value")===r&&VideoDonate.onChoosePayMethod(i)}),radioval("video_donate_pay_method")||VideoDonate.onChoosePayMethod(n[0]);var d=VideoDonate.params.prefilled;d.email&&val("video_donate_email",d.email.value),ge("video_donate_billing_submit").onclick=VideoDonate.submitBillingForm,hide("video_donate_pr"),show("video_donate_step_basic")},onChooseCurrency:function(e){var i=VideoDonate.apiData,t=floatval(i.user_data.donation_mins.RUB),o=Math.ceil(t/vk.vcost),a=void 0,n=floatval(val("video_donate_amount"));if(n){var r=void 0;r="votes"==e?Math.max(o,Math.round(n/vk.vcost)):Math.max(t,intval(n*vk.vcost)),val("video_donate_amount",r)}else{var d="votes"==e?o:t;val("video_donate_amount",d)}"votes"==e?(a=getLang("video_donate_box_min_amount_votes_hint",o),a+=" "+getLang("video_donate_box_total_votes_hint",vk.balance)):a=getLang("video_donate_box_min_amount_hint",t,!0),val("video_donate_amount_hint",a);var s=!!intval(i.user_data.tts_is_enabled),l=floatval((i.user_data.tts_mins||{}).RUB);s&&(l?"votes"==e?val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_min_votes_hint",Math.ceil(l/vk.vcost))):val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_min_hint",l)):val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_hint")));var v=getLang("votes"==e?"video_donate_box_pay_button":"video_donate_box_donate_button");val("video_donate_basic_submit",v)},checkCommentLength:function(e){var i=VideoDonate.apiData,t=e.currentTarget,o=val(t),a=o.length,n=i.user_data.max_comment_length||VideoDonate.COMMENT_MAX_LENGTH,r="";if(a>n)r=getLang("video_donate_box_comment_too_long");else if(a>n-100){var d=n-a;r=getLang("text_N_symbols_remain",d)}val("video_donate_comment_length_hint",r)},showInputError:function(e,i){e=ge(e),notaBene(e),i&&(showTooltip(e,{text:i,shift:[0,7,7],dir:"auto",nohide:!0,hasover:!0,showsp:300,onHide:function(){e.onkeydown=e.onblur=null,setTimeout(tooltips.destroy.bind(tooltips,e),300)}}),e.onkeydown=e.onblur=function(){e.tt&&tooltips.hide(e)})},submitBasicForm:function(e){var i=e.currentTarget,t=VideoDonate.apiData,o=val("video_donate_name"),a=VideoDonate.currencyDropdown?VideoDonate.currencyDropdown.val():"rubles",n=val("video_donate_comment"),r=floatval(val("video_donate_amount")),d=0;if("votes"==a&&(d=r,r*=vk.vcost),!r||r<t.user_data.donation_mins.RUB)return VideoDonate.showInputError("video_donate_amount"),!1;if(n.length>VideoDonate.COMMENT_MAX_LENGTH)return VideoDonate.showInputError("video_donate_comment"),!1;var s={step:"basic",referrer:VideoDonate.params.referrer,currency:"RUB",name:o,amount:r,comment:n};lockButton(i),ajax.plainpost(t.form_api_ssl_url,{data:ajx2q(s)},function(e){unlockButton(i),e=JSON.parse(e),e&&"success"==e.status?"votes"==a?VideoDonate.donateVotes(o,d,n):VideoDonate.toNextForm():e&&e.errors&&each(e.errors,function(e,i){var t=VideoDonate.getErrorText(i.code);return VideoDonate.showInputError("video_donate_"+i.field,t),!1})},function(){unlockButton(i)})},donateVotes:function(e,i,t){ajax.post("al_video.php?act=donate_votes",{video:VideoDonate.params.videoId,hash:VideoDonate.params.votesHash,name:e,amount:i,comment:t},{onDone:function(e,i,t){if(e){curBox().hide();var o=getTemplate("video_donate_success_msg",{text:i});showFastBox(getLang("video_donate_box_title"),o)}else VideoDonate.showInputError("video_donate_amount",i);vk.balance!=t&&updateMoney(t)},showProgress:lockButton.pbind("video_donate_basic_submit"),hideProgress:unlockButton.pbind("video_donate_basic_submit")}),statlogsValueEvent("video_donate","","checkout","votes")},toNextForm:function(){hide("video_donate_step_basic"),show("video_donate_step_billing"),curBox().setBackTitle(VideoDonate.toPrevForm)},toPrevForm:function(){hide("video_donate_step_billing"),show("video_donate_step_basic"),curBox().setBackTitle()},onChoosePayMethod:function(e){var i=VideoDonate.apiData,t=VideoDonate.params.prefilled,o=domData(e,"value");radiobtn(e,o,"video_donate_pay_method");var a=i.payin_currencies[o].additional_fields,n="";a&&each(a,function(e,i){var a="",r="",d="";"MOBILE_FAKE"==o&&"phone"==e?(a=getLang("video_donate_box_sms_payment_phone_placeholder"),r=getLang("video_donate_box_sms_payment_phone_hint"),d=t.phone?t.phone.value:""):"QIWI_MYCOM"==o&&"phone_number"==e&&(a=getLang("video_donate_box_qiwi_payment_phone_placeholder"),r=getLang("video_donate_box_qiwi_payment_phone_hint")),(a||r)&&(n+=getTemplate("video_donate_additional_field",{name:e,placeholder:a,hint:r,required:intval(i.required),prefilled:d,input_id:""}))}),val("video_donate_billing_additional_fields",n)},submitBillingForm:function(e){var i=VideoDonate.apiData,t=e.currentTarget,o=radioval("video_donate_pay_method"),a=VideoDonate.params.prefilled,n=val("video_donate_email");if(!/^.+@.+\..+$/.test(n))return VideoDonate.showInputError("video_donate_email"),!1;var r={step:"billing",referrer:VideoDonate.params.referrer,name:val("video_donate_name"),amount:floatval(val("video_donate_amount")),currency:"RUB",comment:val("video_donate_comment"),billing_system_type:o,redirect:1,vk_test_group:VideoDonate.params.votesHash?1:2,_vk_id_encrypted:VideoDonate.params.payerId};a.email&&n==a.email.value?r.email_encrypted=a.email.encrypted:r.email=n;var d=!0;if(each(geByClass("video_donate_input","video_donate_billing_additional_fields"),function(e,t){var n=domData(t,"name"),s=val(t),l=intval(domData(t,"required"));if("MOBILE_FAKE"==o&&"phone"==n&&a.phone&&replaceEntities(a.phone.value)==s)n+="_encrypted",s=a.phone.encrypted;else if(s||l){s=s.replace(/\s+/g,"");var v=i.payin_currencies[o].additional_fields[n],c=v.regex_validation;if(c&&!new RegExp(c).test(s))return VideoDonate.showInputError(t),d=!1,!1}r[n]=s}),d){if("MOBILE_FAKE"==o){var s=function(e){if(unlockButton(t),e=JSON.parse(e),e&&"success"==e.status){curBox().hide();var i=getTemplate("video_donate_success_msg",{text:getLang("video_donate_box_sms_payment_success")});showFastBox(getLang("video_donate_box_title"),i)}else e&&e.errors&&each(geByClass("video_donate_input","video_donate_billing_additional_fields"),function(i,t){var o=domData(t,"name");if(e.errors[o]){var a=VideoDonate.getErrorText(e.errors[o].code);return VideoDonate.showInputError(t,a),!1}})},l=function(){unlockButton(t)};ajax.plainpost(i.form_api_ssl_url,{data:ajx2q(r)},s,l),lockButton(t)}else{var v=ce("iframe"),c=ce("form",{action:i.form_api_ssl_url,method:"post",target:"_blank",innerHTML:'<input type="hidden" name="data" value="'+ajx2q(r)+'"/>'});utilsNode.appendChild(v),v.contentDocument.body.appendChild(c),c.submit(),setTimeout(function(){re(v)},0),curBox().hide()}statlogsValueEvent("video_donate","","checkout",o),ls.set("video_donate_pay_method",o)}},getErrorText:function(e){switch(e){case"special_characters_violation":return getLang("video_donate_special_chars_error");case"max_username_length_violation":return getLang("video_donate_username_length_error");case"mc_provider_violation":return getLang("video_donate_phone_provider_error");case"mc_provider_not_found":return getLang("video_donate_phone_provider_not_found_error")}},onDestroy:function(){delete VideoDonate.params,delete VideoDonate.apiData,VideoDonate.currencyDropdown&&(VideoDonate.currencyDropdown.destroy(),VideoDonate.currencyDropdown=null)}}},function(e,i){"use strict";function t(e){var i=PageID;return function(){i==PageID&&e.apply(this,arguments)}}function o(e,i){return setTimeout(t(e),i)}function a(e,i){return Math.random()*(i-e+1)+e}function n(e,i){return Math.floor(a(e,i))}function r(e){return"undefined"==typeof e}function d(e){return e&&"[object Function]"===Object.prototype.toString.call(e)}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(e){return"string"==typeof e}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;for(var i in e)if(e.hasOwnProperty(i))return!1;return!0}function u(){return+new Date}function m(){return window.Image?new Image:ce("img")}function _(e){return(e||"").replace(/^\s+|\s+$/g,"")}function p(e){return e?e.replace(/<(?:.|\s)*?>/g,""):""}function h(e){return e?e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"):""}function f(e){return e===!0?1:parseInt(e)||0}function w(e){return e===!0?1:parseFloat(e)||0}function g(e){return e=f(e),0>e?0:e}function y(e){return!isNaN(e)}function V(e){return e.replace(/&#(\d\d+);/g,function(e,i){return i=f(i),i>=32?String.fromCharCode(i):e}).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")}function b(e){return se("<textarea>"+(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+"</textarea>").value}function C(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function S(e){return b(e.replace(/\t/g,"\n"))}function k(e,i){if(v(e)||"undefined"==typeof e.length){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&i.call(e[t],t,e[t])===!1)break}else for(var o=0,a=e.length;a>o;o++){var n=e[o];if(i.call(n,o,n)===!1)break}return e}function x(e,i,t){for(var o=t||0,a=(e||[]).length;a>o;o++)if(e[o]==i)return o;return-1}function D(e,i){return-1!=x(i,e)}function L(e,i){var t=v(e)||"undefined"==typeof e.length?{}:[];for(var o in e)(!/webkit/i.test(_ua)||"layerX"!=o&&"layerY"!=o&&"webkitMovementX"!=o&&"webkitMovementY"!=o)&&(i&&"object"===A(e[o])&&"prototype"!==o&&null!==e[o]?t[o]=L(e[o]):t[o]=e[o]);return t}function T(e){var i,t,o={},a=1,n=arguments.length,r=arguments;for(i in e){for(t=!1,a=1;n>a;a++)r[a][i]&&r[a][i]==e[i]&&(t=!0);t||(o[i]=e[i])}return o}function P(){var e,i=arguments,t=i[0]||{},o=1,a=i.length,n=!1;for("boolean"==typeof t&&(n=t,t=i[1]||{},o=2),"object"===("undefined"==typeof t?"undefined":A(t))||d(t)||(t={});a>o;++o)if(null!=(e=i[o]))for(var r in e){var s=t[r],l=e[r];t!==l&&(n&&l&&"object"===("undefined"==typeof l?"undefined":A(l))&&!l.nodeType?t[r]=P(n,s||(null!=l.length?[]:{}),l):void 0!==l&&(t[r]=l))}return t}function B(e){window.templates=window.templates||{},P(window.templates,e)}function E(e,i){var t=window.templates=window.templates||{},o=t[e];return"function"==typeof o&&(o=o()),o&&i?rs(o,i):o||""}function I(e){if("object"!=("undefined"==typeof e?"undefined":A(e)))return!1;var i={},t=function(i){return geByTag(i,e)},o=function(t,o){if(o.name)if("text"!=o.type&&o.type)if(o.getAttribute("bool")){var a=val(o);if(!a||"0"===a)return;i[o.name]=1}else i[o.name]=browser.msie&&!o.value&&e[o.name]?e[o.name].value:o.value;else i[o.name]=val(o)};return k(t("input"),function(e,i){return"radio"!=i.type&&"checkbox"!=i.type||i.checked?o(e,i):void 0}),k(t("select"),o),k(t("textarea"),o),i}function M(e,i){for(var t,o=i?R:N,a=[];e&&(t=e.match(o));){e=e.substr(t.index+t[0].length);var n=0;t[4]||(n=7),a.push({url:t[2+n],query:t[5+n]||"",domain:t[4+n]})}return a}function z(){return window.devicePixelRatio>=2}Object.defineProperty(i,"__esModule",{value:!0});var A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.vkLocal=t,i.lTimeout=o,i.rand=a,i.irand=n,i.isUndefined=r,i.isFunction=d,i.isArray=s,i.isString=l,i.isObject=v,i.isEmpty=c,i.vkNow=u,i.vkImage=m,i.trim=_,i.stripHTML=p,i.escapeRE=h,i.intval=f,i.floatval=w,i.positive=g,i.isNumeric=y,i.winToUtf=V,i.replaceEntities=b,i.clean=C,i.unclean=S,i.each=k,i.indexOf=x,i.inArray=D,i.clone=L,i.arrayKeyDiff=T,i.extend=P,i.addTemplates=B,i.getTemplate=E,i.serializeForm=I,i.extractUrls=M,i.isRetina=z,window.PageID=window.PageID||1;var N=/(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0]))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)]*(&nbsp;|[ \t\r\n \u00A0])))/i,R=/(?:([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9_\-]+\.)+(?:[a-z]{2,9}|xn--p1ai|xn--j1amh|xn--80asehdb|xn--80aswg))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$))|([!()?., \n\r\t \u00A0]|^)((https?:\/\/)?((?:[a-z0-9а-яєґї_\-]+\.)+(?:рф|укр|онлайн|сайт|срб))(\/.*?)?(\#.*?)?)(?:[\.!:;,\*\(\)&]*(&nbsp;|[ \t\r\n \u00A0]|$)))/i;window.isRetina=z,window.extractUrls=M,window.serializeForm=I,window.addTemplates=B,window.getTemplate=E,window.rand=a,window.irand=n,window.isUndefined=r,window.isFunction=d,window.isArray=s,window.isString=l,window.isObject=v,window.isEmpty=c,window.vkNow=u,window.vkImage=m,window.trim=_,window.stripHTML=p,window.escapeRE=h,window.intval=f,window.floatval=w,window.positive=g,window.isNumeric=y,window.winToUtf=V,window.replaceEntities=b,window.clean=C,window.unclean=S,window.each=k,window.indexOf=x,window.inArray=D,window.clone=L,window.arrayKeyDiff=T,window.extend=P,window.vkLocal=t,window.lTimeout=o},function(e,i,t){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var a=t(5),n=o(a),r=t(8),d=o(r),s=t(4),l=o(s),v=t(1),c=o(v),u=t(9),m=o(u),_=t(3),p=o(_);window.Videoview=window.videoview=n["default"],window.VideoPlaylist=d["default"],window.VideoChat=l["default"],window.VideoInitializer=c["default"],window.VideoDonate=m["default"],window.VideoLiveBlacklistBox=p["default"];try{stManager.done("videoview.js")}catch(h){}}]);